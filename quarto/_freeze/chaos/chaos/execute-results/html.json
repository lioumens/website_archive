{
  "hash": "3a032b9e78481f25bc425bd2264fc938",
  "result": {
    "markdown": "---\ntitle: \"Chaos\"\nauthor: \"Michael Liou\"\nformat: html\n---\n\n::: {.cell hash='chaos_cache/html/unnamed-chunk-1_fd9b81ee827936009d6dd089697253b6'}\n\n```{.r .cell-code}\nlibrary(purrr)\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'scales'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n:::\n:::\n\n\n\n## Lyapanov exponent\n\nGenerally measures the overall sensitivity to initial conditions. Suppose we start two trajectories, $x$ and $y$ and let $\\delta(0) = x(0)y(0)$\n\n\n::: {.cell hash='chaos_cache/html/unnamed-chunk-2_b525d2d9fe281f9d5e954d8607e94a3f'}\n\n```{.r .cell-code}\nlogistic_map <- function(x0, n, r) {\n  x <- vector(mode = \"numeric\", length = n + 1)\n  x[1] <- x0\n  logistic <- function(x) r * x*(1 - x)\n  for (i in 1:n) {\n    x[i+1] <- logistic(x[i])\n  }\n  # lya only if n > 200\n  \n  lya <- ifelse(n > 200,\n                mean(log(abs(r - 2 * r * x[100:length(x)]))),\n                NA)\n  structure(list(x = x, lya = lya, n = n, r = r),\n            class = \"chaos\")\n}\n\nx <- logistic_map(.1, 500, 3.5)\n\nplot.chaos <- function(chaos_obj) {\n  x <- chaos_obj$x\n  r <- chaos_obj$r\n  plot(c(0, 1), c(0, 1), type = \"n\",\n       xlab = \"\",\n       ylab = \"\")\n  \n  abline(a = 0, b = 1, lty = 2)\n  \n  y <- seq(0,1, .01)\n  lines(y, r * y * (1 - y))\n  segments(x[1], 0, x[1], x[2])\n  segments(x[1], x[2], x[2], x[2])\n  \n  s <- seq(2, length(x) - 2)\n  alphas <- exp(seq(0, -5, length.out = length(s)))\n  segments(x[s], x[s], x[s], x[s+1], col = alpha(\"black\", alpha = alphas))\n  segments(x[s], x[s+1], x[s+1], x[s+1], col = alpha(\"black\", alpha = alphas))\n}\nplot(x)\n```\n\n::: {.cell-output-display}\n![](chaos_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='chaos_cache/html/unnamed-chunk-3_2c4c020946cd63dbe8e89f2c812a1229'}\n\n```{.r .cell-code}\nrs <- seq(0, 4, .0001)\nxn <- rs |> map_dbl(~logistic_map(runif(1, .1, .9), 100, .x)$x[101])\nplot(rs, xn, pch = \".\", xlab = \"r\", ylab = \"x\", main = \"Bifurcation of Logistic Map\")\n```\n\n::: {.cell-output-display}\n![](chaos_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nWe'll try to look at the Lyaponov plot here.\n\n\n::: {.cell hash='chaos_cache/html/unnamed-chunk-4_35a416401616a62a282e5565d80240cd'}\n\n```{.r .cell-code}\nrs <- seq(0, 4.5, .01)\nlyas <- rs |> map_dbl(~logistic_map(.1, 500, .x)$lya)\n\nplot(rs, lyas, pch = \".\", cex = 2, main = \"Lyaponov Exponent Plot\",xlab = \"r\", ylab = \"Lyaponov Exponent\")\nabline(h = 0, col = 2, lty = 2)\n```\n\n::: {.cell-output-display}\n![](chaos_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}