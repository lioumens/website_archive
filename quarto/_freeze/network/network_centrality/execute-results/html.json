{
  "hash": "9dca28dabd99870fbb89aebac7e9c886",
  "result": {
    "markdown": "---\ntitle: \"Network Centrality\"\nauthor: \"Michael Liou\"\nformat: html\neditor: visual\n---\n\n::: {.cell hash='network_centrality_cache/html/setup_abf36daaeab92ba7875116b568adb23a'}\n\n```{.r .cell-code}\nlibrary(igraph)\nlibrary(ggraph)\nlibrary(tidygraph)\nlibrary(netrankr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ergm)\n```\n:::\n\n\n## Introduction\n\nSeveral types of measuring centrality\n\n1.  Degree\n\nCounting the number of in/out edges. summing by weight\n\n2.  Eigenvalue\n\nCaptures the idea that being connected to someone else important means that you yourself are important.\n\n3.  Katz\n\n4.  PageRank\n\n## Network Fixtures\n\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-2_8d2390459ab7757ac3a517c466993f67'}\n\n```{.r .cell-code}\nset.seed(1)\n# ER random graph, 20 nodes, average 5/20 connections, directed\ng_uni <- sample_gnp(20, 5/20, directed=TRUE)\n\n# Simple 1,1, 2, 3 graph\ng_simple_adj_matrix <- matrix(c(0, 1, 1, 1,\n                     1, 0, 0, 1,\n                     1, 0, 0, 0,\n                     1, 1, 0, 0),\n                     nrow = 4, ncol = 4)\n\ng_simple <- graph_from_adjacency_matrix(g_simple_adj_matrix, mode = \"undirected\")\n# g_simple %>% set_vertex_attr(\"name\", value = letters[1:4]) # label with alphabet\n\n# ER random graph, 20 nodes, average 5/20, undirected\n\ng_uni_bi <- sample_gnp(20, 5/20, directed=TRUE)\n\n\n# Simple Directed graph, acyclic\ng_simple_dir_adj_matrix <- matrix(c(0, 1, 1, 0, 1, 0, 0, 0,\n                                    0, 0, 1, 1, 0, 0, 0, 0,\n                                    0, 0, 0, 0, 0, 1, 0, 0,\n                                    0, 0, 0, 0, 1, 0, 1, 0,\n                                    0, 0, 0, 0, 0, 0, 0, 0,\n                                    0, 0, 0, 0, 0, 0, 0, 0,\n                                    0, 0, 0, 0, 0, 0, 0, 0,\n                                    0, 0, 0, 0, 0, 1, 0, 0),\n                                  nrow = 8,\n                                  ncol = 8,\n                                  byrow = TRUE)\n\ng_simple_dir <- graph_from_adjacency_matrix(g_simple_dir_adj_matrix, mode = \"directed\")\n```\n:::\n\n\n## Eigenvalue centrality\n\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-3_3093348833e442ee4ee488289b88c2b5'}\n\n```{.r .cell-code}\n# The graph we look at\nggraph(g_simple, layout = \"kk\") +\n  geom_edge_fan() +\n  geom_node_label(aes(label = 1:4))\n```\n\n::: {.cell-output-display}\n![](network_centrality_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-4_9d9c856bf52513b9412c70948818c61a'}\n\n```{.r .cell-code}\n# Eigenvector centrality through igraph\ncent_eig_igraph <- eigen_centrality(g_simple)$vector\n# Through eigenvector decomp\ncent_eig_manual <- eigen(g_simple_adj_matrix)$vectors[,1] / eigen(g_simple_adj_matrix)$vectors[1,1]\n\n# They are the same!\ncbind(\n  cent_eig_igraph, # Eigencentrality\n  cent_eig_manual # eig centrality calculation\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     cent_eig_igraph cent_eig_manual\n[1,]       1.0000000       1.0000000\n[2,]       0.8546377       0.8546377\n[3,]       0.4608111       0.4608111\n[4,]       0.8546377       0.8546377\n```\n:::\n:::\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-5_30f3b5784c9db62ad1864e1be995ebfd'}\n\n```{.r .cell-code}\n# Note how\neigen_centrality\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfunction (graph, directed = FALSE, scale = TRUE, weights = NULL, \n    options = arpack_defaults) \n{\n    if (!is_igraph(graph)) {\n        stop(\"Not a graph object\")\n    }\n    directed <- as.logical(directed)\n    scale <- as.logical(scale)\n    if (is.null(weights) && \"weight\" %in% edge_attr_names(graph)) {\n        weights <- E(graph)$weight\n    }\n    if (!is.null(weights) && any(!is.na(weights))) {\n        weights <- as.numeric(weights)\n    }\n    else {\n        weights <- NULL\n    }\n    options.tmp <- arpack_defaults\n    options.tmp[names(options)] <- options\n    options <- options.tmp\n    on.exit(.Call(C_R_igraph_finalizer))\n    res <- .Call(C_R_igraph_eigenvector_centrality, graph, directed, \n        scale, weights, options)\n    if (igraph_opt(\"add.vertex.names\") && is_named(graph)) {\n        names(res$vector) <- vertex_attr(graph, \"name\", V(graph))\n    }\n    res\n}\n<bytecode: 0x7ff30c39be38>\n<environment: namespace:igraph>\n```\n:::\n\n```{.r .cell-code}\neigen_centrality(g_simple_dir)$vector\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9767991 1.0000000 0.9081894 0.7377802 0.6537287 0.4051718 0.2812982\n[8] 0.1544825\n```\n:::\n\n```{.r .cell-code}\neigen(g_simple_dir_adj_matrix)$vectors[,1] / eigen(g_simple_adj_matrix)$vectors[1,1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.63498 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000\n```\n:::\n:::\n\n\n## Katz Centrality\n\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-6_73c919ebec21f274d3554fc3a3b063e4'}\n\n```{.r .cell-code}\nlength(V(g_simple_dir))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\nggraph(g_simple_dir, layout = \"kk\") +\n  geom_edge_fan(arrow = arrow(length = unit(4, \"mm\")),\n                end_cap = circle(3, \"mm\")) +\n  geom_node_label(aes(label = 1:length(V(g_simple_dir))))\n```\n\n::: {.cell-output-display}\n![](network_centrality_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-7_f24cecf43429a6f88eec9c27ccb1f48c'}\n\n```{.r .cell-code}\n# Calculating Katz Centrality with tidygraph (rank ordered?)\n# Only undirected?\nas_tbl_graph(g_simple) %>% \n  mutate(centrality = centrality_katz())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tbl_graph: 4 nodes and 4 edges\n#\n# An undirected simple graph with 1 component\n#\n# Node Data: 4 × 1 (active)\n  centrality\n       <dbl>\n1      119. \n2      101. \n3       55.1\n4      101. \n#\n# Edge Data: 4 × 2\n   from    to\n  <int> <int>\n1     1     2\n2     1     3\n3     1     4\n# … with 1 more row\n```\n:::\n:::\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-8_9f1bbcb25eb0f3c3373fd545671801f8'}\n\n```{.r .cell-code}\nalpha_centrality(g_simple_dir, alpha = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1 2 4 3 5 6 4 1\n```\n:::\n:::\n\n\n## PageRank\n\n\n::: {.cell hash='network_centrality_cache/html/unnamed-chunk-9_a9c828212e4e09af767e2f92d3051eb3'}\n\n```{.r .cell-code}\npage_rank(g_simple)$vector\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3667359 0.2459278 0.1414085 0.2459278\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}