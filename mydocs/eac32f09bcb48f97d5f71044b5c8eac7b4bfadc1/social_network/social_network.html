<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Liou">
<meta name="dcterms.date" content="2022-12-19">

<title>Personal Documentation - 28&nbsp; Social Network Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../spatial/carbayes.html" rel="next">
<link href="../plant_breeding/plant_breeding.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Social Network Analysis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Documentation</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Front Page</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced/advanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Advanced R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approximation/approximation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Approximation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayesian/bayesian.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../categorical/categorical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../changepoint/changepoint.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Changepoint Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../crossover/crossover.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Crossover Designs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/diffeq.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Differential Equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../epidemiology/epidemiology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Epidemiology</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../experimentaldesign/experimentaldesign.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Experimental Design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exponential/exponential.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exponential Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gam/gam.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Generalized Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/longitudinal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/randomcoef.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Random Coefficient Models (CALS)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/within_between.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Within-Between Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrix/matrix.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Matrix Math</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../meta/meta.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Meta Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mixed/mixed.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Mixed Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mixed/mixed_variance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Mixed Models (Variance)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../network/network_centrality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Network Centrality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../network/network_gnar.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">GNAR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../next_gen_sequencing/next_gen_sequencing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Next Generation Sequencing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../observable/observable.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Observable Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../optimization/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ordination/ordination.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Ordination</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallel/parallel.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Parallel Computing in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plant_breeding/plant_breeding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Plant Breeding</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../social_network/social_network.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Social Network Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../spatial/carbayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">CARBayes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../spatial/spatial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Spatial Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic/stochastic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stochastic</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../timeseries/timeseries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Time Series</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Draft</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bootstrap/bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../causal/causal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Causal Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensitivity/sensitivity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/signal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Signal Processing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../color/color.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Colors in R</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#visualizing-networks" id="toc-visualizing-networks" class="nav-link active" data-scroll-target="#visualizing-networks"><span class="toc-section-number">29</span>  Visualizing Networks</a></li>
  <li><a href="#sienna" id="toc-sienna" class="nav-link" data-scroll-target="#sienna"><span class="toc-section-number">30</span>  Sienna</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="toc-section-number">30.1</span>  Introduction</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="toc-section-number">30.2</span>  Resources</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><span class="toc-section-number">30.3</span>  Model Specification</a></li>
  <li><a href="#meta-analysis-in-rsienna" id="toc-meta-analysis-in-rsienna" class="nav-link" data-scroll-target="#meta-analysis-in-rsienna"><span class="toc-section-number">30.4</span>  Meta Analysis in Rsienna</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="toc-section-number">30.5</span>  Examples</a>
  <ul class="collapse">
  <li><a href="#ph819-lab-single-network-two-timepoints" id="toc-ph819-lab-single-network-two-timepoints" class="nav-link" data-scroll-target="#ph819-lab-single-network-two-timepoints"><span class="toc-section-number">30.5.1</span>  PH819 Lab (single network, two timepoints)</a></li>
  <li><a href="#ph819-lab-meta-analysis-4-networks-2-timepoints-each" id="toc-ph819-lab-meta-analysis-4-networks-2-timepoints-each" class="nav-link" data-scroll-target="#ph819-lab-meta-analysis-4-networks-2-timepoints-each"><span class="toc-section-number">30.5.2</span>  PH819 Lab Meta analysis (4 networks, 2 timepoints each)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exponential-random-graphs" id="toc-exponential-random-graphs" class="nav-link" data-scroll-target="#exponential-random-graphs"><span class="toc-section-number">31</span>  Exponential Random Graphs</a>
  <ul class="collapse">
  <li><a href="#lazega-example" id="toc-lazega-example" class="nav-link" data-scroll-target="#lazega-example"><span class="toc-section-number">31.1</span>  Lazega example</a></li>
  </ul></li>
  <li><a href="#linear-regression-w-matrices" id="toc-linear-regression-w-matrices" class="nav-link" data-scroll-target="#linear-regression-w-matrices"><span class="toc-section-number">32</span>  Linear Regression w/ Matrices</a>
  <ul class="collapse">
  <li><a href="#resources-1" id="toc-resources-1" class="nav-link" data-scroll-target="#resources-1"><span class="toc-section-number">32.1</span>  Resources</a></li>
  <li><a href="#qap-with-correlation" id="toc-qap-with-correlation" class="nav-link" data-scroll-target="#qap-with-correlation"><span class="toc-section-number">32.2</span>  QAP with correlation</a></li>
  </ul></li>
  <li><a href="#permuting-matrices" id="toc-permuting-matrices" class="nav-link" data-scroll-target="#permuting-matrices"><span class="toc-section-number">33</span>  Permuting matrices</a></li>
  <li><a href="#network-block-models" id="toc-network-block-models" class="nav-link" data-scroll-target="#network-block-models"><span class="toc-section-number">34</span>  Network Block Models</a></li>
  <li><a href="#latent-network-models" id="toc-latent-network-models" class="nav-link" data-scroll-target="#latent-network-models"><span class="toc-section-number">35</span>  Latent Network Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Social Network Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Liou </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 19, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-1_2a3ebdbdb69a1cf8429efec84c976fe2">
<details>
<summary>Libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asnipe)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ergm) <span class="co"># exponential random graph models</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eigenmodel) <span class="co"># latent models by peter hoff</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(network)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sand) <span class="co"># statistical analysis of network data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSiena) <span class="co"># Simulation Investigation for Empirical Network Analysis</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="visualizing-networks" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Visualizing Networks</h1>
<ul>
<li><a href="https://ggraph.data-imaginist.com/">ggraph</a> - a nice interface for network data into ggplot</li>
<li><a href="">gephi</a> - has been around a while</li>
<li><a href="">UCINET</a> - windows only</li>
<li><a href="">Pajek</a> - very nice interface</li>
</ul>
</section>
<section id="sienna" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Sienna</h1>
<section id="introduction" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">30.1</span> Introduction</h2>
<p>Stands for Simulation Investigation for Empirical Network Analysis, named after the city in which the work for this started.</p>
<p>Program for statistical analysis of network data, with the focus on social networks. There’s some interesting context for this</p>
<p>The basic model fit</p>
</section>
<section id="resources" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="resources"><span class="header-section-number">30.2</span> Resources</h2>
<ul>
<li><a href="https://www.stats.ox.ac.uk/~snijders/siena/">Informational Website</a> - the home website for the SIENNA Project. The website also contains many helpful example scripts and datasets.</li>
<li><a href="https://www.stats.ox.ac.uk/~snijders/siena/RSiena_Manual.pdf#section.8">Manual for R</a> - This is the place to get started with SIENA modeling, with a longer, practical introduction to using their software.</li>
<li><a href="duke workshop materials/Day 5 - SIENA Models/">Duke 2018 Workshop Materials</a> - There’s some powerpoints with details calculations of how each objective function and evaluation function actually plays out for change in the dyad.
<ul>
<li><a href="https://sites.duke.edu/dnac/training/">Links to all the resources and lectures</a> - the entire workshop materials listed on the website.</li>
</ul></li>
</ul>
</section>
<section id="model-specification" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="model-specification"><span class="header-section-number">30.3</span> Model Specification</h2>
<p>See Section 5 of <a href="https://www.stats.ox.ac.uk/~snijders/siena/RSiena_Manual.pdf#section.5">Manual for R</a></p>
<p>There are 4 types of functions in the model specification:</p>
<ol type="1">
<li>Rate functions - how often do we get the opportunity to change around the specification?</li>
<li>Evaluation functions - determines the probability of changing their ties. Can be thought of evaluating “satisfaction” for each actor’s local environment, actors will change to increase their total satisfaction.</li>
<li>Creation function - probability of changes only in the creation of new ties.</li>
<li>Maintenance function - probability of changes only in the maintenance and termination of existing ties.</li>
</ol>
<p>Most of the time we’re only using the first 2, rate and evaluation, with most of the focus on the evaluation function</p>
</section>
<section id="meta-analysis-in-rsienna" class="level2" data-number="30.4">
<h2 data-number="30.4" class="anchored" data-anchor-id="meta-analysis-in-rsienna"><span class="header-section-number">30.4</span> Meta Analysis in Rsienna</h2>
<p>The idea is to fit SABM’s to each network, and combine the parameter estimates intelligently from all the studies. We could also consider combining the network into one large network and add structural zeros for nodes from different networks, this would also work, but apparently it’s very slow running as a large diagonal block matrix in RSienna.</p>
</section>
<section id="examples" class="level2" data-number="30.5">
<h2 data-number="30.5" class="anchored" data-anchor-id="examples"><span class="header-section-number">30.5</span> Examples</h2>
<section id="ph819-lab-single-network-two-timepoints" class="level3" data-number="30.5.1">
<h3 data-number="30.5.1" class="anchored" data-anchor-id="ph819-lab-single-network-two-timepoints"><span class="header-section-number">30.5.1</span> PH819 Lab (single network, two timepoints)</h3>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-2_5ec1e0de50eb0c062948aa7d144ccbe8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>friend.data.w1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class5809.txt"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>friend.data.w2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class5809_t2.txt"</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>attr5809<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"data/attr5809.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(attr5809)) {<span class="cf">if</span> (attr5809[i,<span class="dv">50</span>] <span class="sc">&gt;</span> <span class="dv">98</span>) {friend.data.w2[i,]<span class="ot">=</span><span class="dv">9</span>}}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>friend.data.w1[friend.data.w1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>friend.data.w2[friend.data.w2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>alcfrq<span class="ot">&lt;-</span><span class="fu">cbind</span>(attr5809[,<span class="dv">45</span>],attr5809[,<span class="dv">48</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>alcfrq[alcfrq <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>alcfrq[alcfrq <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-3_a02a540104272c182d453a64b2f26393">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the networks that we're working with</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>kcoord <span class="ot">&lt;-</span> <span class="fu">gplot.layout.fruchtermanreingold</span>(friend.data.w1, <span class="at">layout.par =</span> <span class="cn">NULL</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(friend.data.w1, <span class="at">coord =</span> kcoord, <span class="at">main =</span> <span class="st">"timepoint 1"</span>, <span class="at">vertex.cex =</span> alcfrq[,<span class="dv">1</span>], <span class="at">object.scale =</span> .<span class="dv">005</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(friend.data.w2, <span class="at">coord =</span> kcoord, <span class="at">main =</span> <span class="st">"timepoint 2"</span>, <span class="at">vertex.cex =</span> alcfrq[,<span class="dv">2</span>], <span class="at">object.scale =</span> .<span class="dv">005</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-4_04f59a4efddc36b4dde13923177a27df">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the network (response) and the behavior attributes for each timepoint</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>friendties <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(<span class="fu">array</span>(<span class="fu">c</span>(friend.data.w1, friend.data.w2),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(attr5809), <span class="fu">nrow</span>(attr5809), <span class="dv">2</span>)))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(alcfrq, <span class="at">type=</span><span class="st">"behavior"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create data covariates</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ah_pvt <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">36</span>]) <span class="co"># denotes constant Covariates</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">38</span>]) </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">40</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>parentdrkfrq <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">53</span>])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>parentdrkfiv <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">54</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>tobacco <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">56</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-5_9ebaa161cff9c252fce43ad1b698ff23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the data object for siena</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data5809 <span class="ot">&lt;-</span> <span class="fu">sienaDataCreate</span>(friendties,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                            ah_pvt, age, male, parentdrkfrq,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                            parentdrkfiv,tobacco,alcdrinkbeh)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>eff5809 <span class="ot">&lt;-</span> <span class="fu">getEffects</span>(data5809)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># prints out a txtfile with more information</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print01Report</span>(data5809, <span class="at">modelname =</span> <span class="st">'class5809_init'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-6_f55b3bed3c46be357ffd83d57e35cbbb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null model, and display the summary without covariance</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># creates output file "class5809_run1.txt"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>model5809 <span class="ot">&lt;-</span> <span class="fu">sienaModelCreate</span>(<span class="at">useStdInits =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">projname =</span> <span class="st">'class5809_run1'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ans5809 <span class="ot">&lt;-</span> <span class="fu">siena07</span>(model5809, <span class="at">data=</span>data5809, <span class="at">effects=</span>eff5809, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">batch=</span><span class="cn">FALSE</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-7_b4381cfb637dcee89b8b9f484a2dd774">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ans5809 <span class="co"># display results from fitting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Estimates, standard errors and convergence t-ratios

                                          Estimate   Standard   Convergence 
                                                       Error      t-ratio   
Network Dynamics 
  1. rate basic rate parameter friendties  8.5126  ( 0.5487   )   -0.0096   
  2. eval outdegree (density)             -2.7250  ( 0.0444   )   -0.0058   
  3. eval reciprocity                      2.5915  ( 0.1137   )   -0.0510   

Behavior Dynamics
  4. rate rate alcdrinkbeh period 1        5.7149  ( 0.9284   )   -0.0260   
  5. eval alcdrinkbeh linear shape        -0.3687  ( 0.0561   )   -0.0001   
  6. eval alcdrinkbeh quadratic shape      0.1546  ( 0.0331   )    0.0059   

Overall maximum convergence ratio:    0.0788 


Total of 2669 iteration steps.</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-8_10c3dc5edd348bb9f096425a2c7a7dc7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald-style p-values can be calculated by</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ans5809<span class="sc">$</span>theta <span class="sc">/</span> ans5809<span class="sc">$</span>se))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000000e+00 0.000000e+00 0.000000e+00 3.738017e-10 2.470590e-11
[6] 1.457415e-06</code></pre>
</div>
</div>
</section>
<section id="ph819-lab-meta-analysis-4-networks-2-timepoints-each" class="level3" data-number="30.5.2">
<h3 data-number="30.5.2" class="anchored" data-anchor-id="ph819-lab-meta-analysis-4-networks-2-timepoints-each"><span class="header-section-number">30.5.2</span> PH819 Lab Meta analysis (4 networks, 2 timepoints each)</h3>
<p>There’s a massive amount of code for this, and we need to run SABM for all 4 models before we can actually do a meta analysis</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-9_3ca33547e7bea676d5a32c6859228654">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Network 1: class 7</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>friend.data.w1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class7.txt"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>friend.data.w2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class7_t2.txt"</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>attr7<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"data/attr7.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(attr7)) {<span class="cf">if</span> (attr7[i,<span class="dv">48</span>] <span class="sc">&gt;</span> <span class="dv">98</span>) {friend.data.w2[i,]<span class="ot">=</span><span class="dv">9</span>}}</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>friend.data.w1[friend.data.w1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>friend.data.w2[friend.data.w2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh<span class="ot">&lt;-</span><span class="fu">cbind</span>(attr7[,<span class="dv">45</span>],attr7[,<span class="dv">48</span>])</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh[alcdrinkbeh <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>friendties <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(<span class="fu">array</span>(<span class="fu">c</span>(friend.data.w1,friend.data.w2),<span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(attr7),<span class="fu">nrow</span>(attr7),<span class="dv">2</span>)))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(alcdrinkbeh,<span class="at">type=</span><span class="st">"behavior"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ah_pvt <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr7[,<span class="dv">36</span>])</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr7[,<span class="dv">38</span>])</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr7[,<span class="dv">40</span>])</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>parentdrkfrq <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr7[,<span class="dv">53</span>])</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>tobacco <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr7[,<span class="dv">56</span>])</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>dataset<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">sienaDataCreate</span>(friendties,ah_pvt,age,male,parentdrkfrq,tobacco,alcdrinkbeh)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">getEffects</span>(dataset<span class="fl">.7</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">effectsDocumentation</span>(effects<span class="fl">.7</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,transTrip,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,cycle3,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age similarity</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,sameX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"male"</span>) <span class="co">#same gender</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#similar scholastic aptitude</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"alcdrinkbeh"</span>) <span class="co">#similar alcoholic use</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,maxAlt,<span class="at">interaction1=</span><span class="st">"friendties"</span>) <span class="co">#average exposure</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># effects.7 &lt;- includeEffects(effects.7,name="alcdrinkbeh",avRecAlt,interaction1="friendties") #average exposure</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age effect</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"parentdrkfrq"</span>) <span class="co">#parent drinking effect</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"tobacco"</span>) <span class="co">#tobacco effect</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.7</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#ah_pvt effect</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>modelall <span class="ot">&lt;-</span> <span class="fu">sienaModelCreate</span>(<span class="at">useStdInits =</span> <span class="cn">FALSE</span>, <span class="at">projname =</span> <span class="st">'AlcoholBehavior'</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>ans<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">siena07</span>(modelall, <span class="at">data=</span>dataset<span class="fl">.7</span>, <span class="at">effects=</span>effects<span class="fl">.7</span>, <span class="at">batch=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-10_5ae92a1934ca654bbc2d62d22b7f9c69">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Network 2: class 5809</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>friend.data.w1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class5809.txt"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>friend.data.w2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class5809_t2.txt"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>attr5809<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"data/attr5809.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(attr5809)) {<span class="cf">if</span> (attr5809[i,<span class="dv">48</span>] <span class="sc">&gt;</span> <span class="dv">98</span>) {friend.data.w2[i,]<span class="ot">=</span><span class="dv">9</span>}}</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>friend.data.w1[friend.data.w1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>friend.data.w2[friend.data.w2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh<span class="ot">&lt;-</span><span class="fu">cbind</span>(attr5809[,<span class="dv">45</span>],attr5809[,<span class="dv">48</span>])</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh[alcdrinkbeh <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>friendties <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(<span class="fu">array</span>(<span class="fu">c</span>(friend.data.w1,friend.data.w2),<span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(attr5809),<span class="fu">nrow</span>(attr5809),<span class="dv">2</span>)))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(alcdrinkbeh,<span class="at">type=</span><span class="st">"behavior"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ah_pvt <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">36</span>])</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">38</span>])</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">40</span>])</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>parentdrkfrq <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">53</span>])</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>tobacco <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr5809[,<span class="dv">56</span>])</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>dataset<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">sienaDataCreate</span>(friendties,ah_pvt,age,male,parentdrkfrq,tobacco,alcdrinkbeh)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">getEffects</span>(dataset<span class="fl">.5809</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,transTrip,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,cycle3,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age similarity</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,sameX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"male"</span>) <span class="co">#same gender</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#similar scholastic aptitude</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"alcdrinkbeh"</span>) <span class="co">#similar alcoholic use</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,maxAlt,<span class="at">interaction1=</span><span class="st">"friendties"</span>) <span class="co">#average exposure</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># effects.5809 &lt;- includeEffects(effects.5809,name="alcdrinkbeh",avRecAlt,interaction1="friendties") #average exposure</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age effect</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"parentdrkfrq"</span>) <span class="co">#parent drinking effect</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"tobacco"</span>) <span class="co">#tobacco effect</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.5809</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#ah_pvt effect</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>modelall <span class="ot">&lt;-</span> <span class="fu">sienaModelCreate</span>(<span class="at">useStdInits =</span> <span class="cn">FALSE</span>, <span class="at">projname =</span> <span class="st">'AlcoholBehavior'</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>ans<span class="fl">.5809</span> <span class="ot">&lt;-</span> <span class="fu">siena07</span>(modelall, <span class="at">data=</span>dataset<span class="fl">.5809</span>, <span class="at">effects=</span>effects<span class="fl">.5809</span>, <span class="at">batch=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-11_790d7abd8adabfccd0db535d8b3ff258">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Network 3: class 8</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>friend.data.w1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class8.txt"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>friend.data.w2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class8_t2.txt"</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>attr8<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"data/attr8.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(attr8)) {<span class="cf">if</span> (attr8[i,<span class="dv">48</span>] <span class="sc">&gt;</span> <span class="dv">98</span>) {friend.data.w2[i,]<span class="ot">=</span><span class="dv">9</span>}}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>friend.data.w1[friend.data.w1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>friend.data.w2[friend.data.w2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh<span class="ot">&lt;-</span><span class="fu">cbind</span>(attr8[,<span class="dv">45</span>],attr8[,<span class="dv">48</span>])</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh[alcdrinkbeh <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>friendties <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(<span class="fu">array</span>(<span class="fu">c</span>(friend.data.w1,friend.data.w2),<span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(attr8),<span class="fu">nrow</span>(attr8),<span class="dv">2</span>)))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(alcdrinkbeh,<span class="at">type=</span><span class="st">"behavior"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ah_pvt <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr8[,<span class="dv">36</span>])</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr8[,<span class="dv">38</span>])</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr8[,<span class="dv">40</span>])</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>parentdrkfrq <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr8[,<span class="dv">53</span>])</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>tobacco <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr8[,<span class="dv">56</span>])</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>dataset<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">sienaDataCreate</span>(friendties,ah_pvt,age,male,parentdrkfrq,tobacco,alcdrinkbeh)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">getEffects</span>(dataset<span class="fl">.8</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,transTrip,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,cycle3,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age similarity</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,sameX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"male"</span>) <span class="co">#same gender</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#similar scholastic aptitude</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"alcdrinkbeh"</span>) <span class="co">#similar alcoholic use</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,maxAlt,<span class="at">interaction1=</span><span class="st">"friendties"</span>) <span class="co">#average exposure</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co"># effects.8 &lt;- includeEffects(effects.8,name="alcdrinkbeh",avRecAlt,interaction1="friendties") #average exposure</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age effect</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"parentdrkfrq"</span>) <span class="co">#parent drinking effect</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"tobacco"</span>) <span class="co">#tobacco effect</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.8</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#ah_pvt effect</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>modelall <span class="ot">&lt;-</span> <span class="fu">sienaModelCreate</span>(<span class="at">useStdInits =</span> <span class="cn">FALSE</span>, <span class="at">projname =</span> <span class="st">'AlcoholBehavior'</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>ans<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">siena07</span>(modelall, <span class="at">data=</span>dataset<span class="fl">.8</span>, <span class="at">effects=</span>effects<span class="fl">.8</span>, <span class="at">batch=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-12_4b662dec6cfbe00018ae60117ae58797">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Network 4: class 88</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>friend.data.w1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class88.txt"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>friend.data.w2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">"data/class88_t2.txt"</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>attr88<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"data/attr88.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(attr88)) {<span class="cf">if</span> (attr88[i,<span class="dv">48</span>] <span class="sc">&gt;</span> <span class="dv">98</span>) {friend.data.w2[i,]<span class="ot">=</span><span class="dv">9</span>}}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>friend.data.w1[friend.data.w1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>friend.data.w2[friend.data.w2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh<span class="ot">&lt;-</span><span class="fu">cbind</span>(attr88[,<span class="dv">45</span>],attr88[,<span class="dv">48</span>])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh[alcdrinkbeh <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">99</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>friendties <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(<span class="fu">array</span>(<span class="fu">c</span>(friend.data.w1,friend.data.w2),<span class="at">dim=</span><span class="fu">c</span>(<span class="fu">nrow</span>(attr88),<span class="fu">nrow</span>(attr88),<span class="dv">2</span>)))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>alcdrinkbeh <span class="ot">&lt;-</span> <span class="fu">sienaNet</span>(alcdrinkbeh,<span class="at">type=</span><span class="st">"behavior"</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ah_pvt <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr88[,<span class="dv">36</span>])</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr88[,<span class="dv">38</span>])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr88[,<span class="dv">40</span>])</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>parentdrkfrq <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr88[,<span class="dv">53</span>])</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>tobacco <span class="ot">&lt;-</span> <span class="fu">coCovar</span>(attr88[,<span class="dv">56</span>])</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>dataset<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">sienaDataCreate</span>(friendties,ah_pvt,age,male,parentdrkfrq,tobacco,alcdrinkbeh)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">getEffects</span>(dataset<span class="fl">.88</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,transTrip,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,cycle3,<span class="at">type=</span><span class="st">"eval"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age similarity</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,sameX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"male"</span>) <span class="co">#same gender</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#similar scholastic aptitude</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,simX,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"alcdrinkbeh"</span>) <span class="co">#similar alcoholic use</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,maxAlt,<span class="at">interaction1=</span><span class="st">"friendties"</span>) <span class="co">#average exposure</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># effects.88 &lt;- includeEffects(effects.88,name="alcdrinkbeh",avRecAlt,interaction1="friendties") #average exposure</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"age"</span>) <span class="co">#age effect</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"parentdrkfrq"</span>) <span class="co">#parent drinking effect</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"tobacco"</span>) <span class="co">#tobacco effect</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>effects<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">includeEffects</span>(effects<span class="fl">.88</span>,<span class="at">name=</span><span class="st">"alcdrinkbeh"</span>,effFrom,<span class="at">type=</span><span class="st">"eval"</span>,<span class="at">interaction1=</span><span class="st">"ah_pvt"</span>) <span class="co">#ah_pvt effect</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>modelall <span class="ot">&lt;-</span> <span class="fu">sienaModelCreate</span>(<span class="at">useStdInits =</span> <span class="cn">FALSE</span>, <span class="at">projname =</span> <span class="st">'AlcoholBehavior'</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>ans<span class="fl">.88</span> <span class="ot">&lt;-</span> <span class="fu">siena07</span>(modelall, <span class="at">data=</span>dataset<span class="fl">.88</span>, <span class="at">effects=</span>effects<span class="fl">.88</span>, <span class="at">batch=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>the actual meta analysis is done by the function <code>siena08()</code>, based on Siena fits.</p>
<ul>
<li>Must have the same covariates fit in the networks. The output of the file is pretty self explanatory.</li>
<li>There’s an automatic warning/filtering if the standard error of any of the variable estimates is &gt;5 because this is a sign of instability, and need to model the networks again.</li>
<li>If you have fit warning, the advice is to check the output simulations and goodness-of-fit parameters to make sure we have a good fit</li>
</ul>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-13_239e5cca5aa31ecf7a2d8ab65d25fb99">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">siena08</span>(ans<span class="fl">.5809</span>, ans<span class="fl">.88</span>, ans<span class="fl">.7</span>, ans<span class="fl">.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in iwlsm.default(x, y, weights, method = method, wt.method =
wt.method, : iwlsm failed to converge in 20 steps</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre style="max-height:600px;"><code>================================= SIENA08 ================================================
Multilevel use of Siena algorithms according to Snijders &amp; Baerveldt (2003) with extension
==========================================================================================

Number of projects in the list is 4.
The names of these projects are :
project1: &lt;AlcoholBehavior(ans.5809)&gt;
project2: &lt;AlcoholBehavior(ans.88)&gt;
project3: &lt;AlcoholBehavior(ans.7)&gt;
project4: &lt;AlcoholBehavior(ans.8)&gt;

Options for running Siena08:
-&gt; Parameters are excluded from the meta-analysis when their standard
   error exceeds an upper bound of 5.
-&gt; Extra output requested

The RSiena Version of the first fit object is 1.3.14.

Object &lt;AlcoholBehavior(ans.5809)&gt; contains estimates of 17 parameters.
The number of valid score tests found was 17.
Object &lt;AlcoholBehavior(ans.7)&gt; contains estimates of 17 parameters.
The number of valid score tests found was 17.
Object &lt;AlcoholBehavior(ans.8)&gt; contains estimates of 17 parameters.
The number of valid score tests found was 17.
Object &lt;AlcoholBehavior(ans.88)&gt; contains estimates of 17 parameters.
The number of valid score tests found was 17.

A total of 17 parameters in 4 projects :
 1. rate : basic rate parameter friendties
 2. eval : outdegree (density)
 3. eval : reciprocity
 4. eval : transitive triplets
 5. eval : 3-cycles
 6. eval : ah_pvt similarity
 7. eval : age similarity
 8. eval : same male
 9. eval : alcdrinkbeh similarity
10. rate : rate alcdrinkbeh period 1
11. eval : alcdrinkbeh linear shape
12. eval : alcdrinkbeh quadratic shape
13. eval : alcdrinkbeh max. alter
14. eval : alcdrinkbeh: effect from ah_pvt
15. eval : alcdrinkbeh: effect from age
16. eval : alcdrinkbeh: effect from parentdrkfrq
17. eval : alcdrinkbeh: effect from tobacco

The projects contain the parameters as follows (1=present, 0=absent):

Project  |    1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17
---------+-----------------------------------------------------
   1     |    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
   2     |    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
   3     |    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
   4     |    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

Project AlcoholBehavior(ans.5809) 
par. 1 estimate       9.8292 (s.e.       0.5833 ) (conv_t   -0.0144 )
 par. 2 estimate      -3.1471 (s.e.       0.0839 ) (conv_t    0.0098 )
 par. 3 estimate       2.3902 (s.e.       0.1302 ) (conv_t    0.0045 )
 par. 4 estimate       0.6644 (s.e.       0.0612 ) (conv_t    0.0027 )
 par. 5 estimate      -0.4685 (s.e.       0.1267 ) (conv_t    0.0183 )
 par. 6 estimate       0.6474 (s.e.       0.2360 ) (conv_t   -0.0576 )
 par. 7 estimate      -0.0497 (s.e.       0.1852 ) (conv_t    0.0193 )
 par. 8 estimate       0.2841 (s.e.       0.0721 ) (conv_t    0.0165 )
 par. 9 estimate       1.6232 (s.e.       0.7060 ) (conv_t    0.0291 )
 par. 10 estimate       6.2508 (s.e.       1.0278 ) (conv_t   -0.0418 )
par. 11 estimate      -0.3628 (s.e.       0.0930 ) (conv_t    0.0965 )
par. 12 estimate       0.0045 (s.e.       0.0223 ) (conv_t   -0.0025 )
par. 13 estimate       0.0133 (s.e.       0.0740 ) (conv_t    0.0252 )
par. 14 estimate      -0.0026 (s.e.       0.0051 ) (conv_t    0.1028 )
par. 15 estimate      -0.0362 (s.e.       0.1053 ) (conv_t   -0.0091 )
par. 16 estimate       0.0130 (s.e.       0.0421 ) (conv_t   -0.0356 )
par. 17 estimate       0.4565 (s.e.       0.1662 ) (conv_t   -0.0228 )

Maximal absolute convergence t-statistic =     0.1028 

Project AlcoholBehavior(ans.7) 
par. 1 estimate       8.0083 (s.e.       0.6869 ) (conv_t    0.0567 )
 par. 2 estimate      -2.9324 (s.e.       0.1028 ) (conv_t    0.0195 )
 par. 3 estimate       2.4027 (s.e.       0.1719 ) (conv_t    0.0725 )
 par. 4 estimate       0.7559 (s.e.       0.0878 ) (conv_t   -0.0255 )
 par. 5 estimate      -0.7416 (s.e.       0.1987 ) (conv_t   -0.0204 )
 par. 6 estimate       0.9396 (s.e.       0.3295 ) (conv_t   -0.0089 )
 par. 7 estimate       1.2576 (s.e.       0.2569 ) (conv_t    0.0308 )
 par. 8 estimate       0.3966 (s.e.       0.1017 ) (conv_t    0.0038 )
 par. 9 estimate       0.4264 (s.e.       0.3829 ) (conv_t   -0.0051 )
 par. 10 estimate       5.1388 (s.e.       1.2683 ) (conv_t    0.0269 )
par. 11 estimate      -0.3858 (s.e.       0.1158 ) (conv_t    0.0550 )
par. 12 estimate       0.0332 (s.e.       0.0346 ) (conv_t    0.0540 )
par. 13 estimate      -0.1452 (s.e.       0.1205 ) (conv_t    0.0258 )
par. 14 estimate       0.0097 (s.e.       0.0088 ) (conv_t   -0.0302 )
par. 15 estimate      -0.0004 (s.e.       0.0549 ) (conv_t    0.0142 )
par. 16 estimate       0.1426 (s.e.       0.0994 ) (conv_t    0.0132 )
par. 17 estimate       0.3567 (s.e.       0.2080 ) (conv_t    0.0045 )

Maximal absolute convergence t-statistic =     0.0725 

Project AlcoholBehavior(ans.8) 
par. 1 estimate       6.5754 (s.e.       0.6509 ) (conv_t    0.0354 )
 par. 2 estimate      -2.4235 (s.e.       0.1275 ) (conv_t    0.0368 )
 par. 3 estimate       1.6312 (s.e.       0.2647 ) (conv_t   -0.0154 )
 par. 4 estimate       0.6344 (s.e.       0.0816 ) (conv_t   -0.0014 )
 par. 5 estimate      -0.4651 (s.e.       0.1770 ) (conv_t   -0.0199 )
 par. 6 estimate       0.7482 (s.e.       0.3947 ) (conv_t    0.0306 )
 par. 7 estimate       1.3274 (s.e.       0.3425 ) (conv_t    0.0113 )
 par. 8 estimate       0.2883 (s.e.       0.1199 ) (conv_t   -0.0067 )
 par. 9 estimate       0.8932 (s.e.       0.5473 ) (conv_t   -0.0251 )
 par. 10 estimate       4.7190 (s.e.       1.9662 ) (conv_t   -0.0388 )
par. 11 estimate      -0.6328 (s.e.       0.2101 ) (conv_t   -0.0179 )
par. 12 estimate       0.0507 (s.e.       0.0520 ) (conv_t   -0.0806 )
par. 13 estimate       0.0674 (s.e.       0.1825 ) (conv_t   -0.0648 )
par. 14 estimate       0.0198 (s.e.       0.0141 ) (conv_t   -0.0684 )
par. 15 estimate       0.0759 (s.e.       0.0701 ) (conv_t   -0.0364 )
par. 16 estimate       0.0674 (s.e.       0.1173 ) (conv_t    0.0413 )
par. 17 estimate       0.0612 (s.e.       0.2558 ) (conv_t   -0.0055 )

Maximal absolute convergence t-statistic =     0.0806 

Project AlcoholBehavior(ans.88) 
par. 1 estimate       8.5888 (s.e.       0.9511 ) (conv_t    0.0581 )
 par. 2 estimate      -2.6220 (s.e.       0.1316 ) (conv_t    0.0660 )
 par. 3 estimate       1.6849 (s.e.       0.2560 ) (conv_t    0.0602 )
 par. 4 estimate       0.4889 (s.e.       0.0696 ) (conv_t    0.0932 )
 par. 5 estimate      -0.3216 (s.e.       0.1768 ) (conv_t    0.0907 )
 par. 6 estimate       0.9429 (s.e.       0.3701 ) (conv_t    0.0450 )
 par. 7 estimate       1.7286 (s.e.       0.4198 ) (conv_t    0.0564 )
 par. 8 estimate       0.0924 (s.e.       0.1292 ) (conv_t    0.0600 )
 par. 9 estimate       0.6717 (s.e.       0.5422 ) (conv_t    0.0553 )
 par. 10 estimate       1.8970 (s.e.       0.7808 ) (conv_t    0.0573 )
par. 11 estimate      -1.1139 (s.e.       0.4904 ) (conv_t    0.0281 )
par. 12 estimate       0.5294 (s.e.       0.5378 ) (conv_t    0.0504 )
par. 13 estimate       0.3070 (s.e.       0.4469 ) (conv_t    0.0356 )
par. 14 estimate      -0.0385 (s.e.       0.0324 ) (conv_t   -0.0657 )
par. 15 estimate       0.0798 (s.e.       0.1718 ) (conv_t   -0.0079 )
par. 16 estimate      -0.1119 (s.e.       0.3499 ) (conv_t    0.0128 )
par. 17 estimate      -0.0197 (s.e.       0.7183 ) (conv_t    0.0150 )

Maximal absolute convergence t-statistic =     0.0932 


=============================
Results of the meta-analysis:
=============================

Upper bound used for standard error is     5.00.

--------------------------------------------------------------------------------
Parameter 1: rate : basic rate parameter friendties
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       9.8292 (standard error        0.58)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       8.5888 (standard error        0.95)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       8.0083 (standard error        0.69)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       6.5754 (standard error        0.65)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.2, two-sided p = 0.917

Test that all parameters are 0 : 
chi-squared = 603.4541, d.f. = 4, p &lt; 0.001

Estimated mean parameter   8.2532 (s.e.   0.6983), two-sided p = 0.001
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    1.3965
Test that variance of parameter is 0 :
Chi-squared =   14.1632 (d.f. = 3), p = 0.003
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   8.2551 (s.e.   0.6316), two-sided p &lt; 0.001
0.95 level confidence interval [  6.6765 ,  9.8245 ]
Estimated standard deviation    1.0425 
0.95 level confidence interval [   0.293 ,   2.926 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =  630.4575 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =         0 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 2: eval : outdegree (density)
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -3.1471 (standard error        0.08)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -2.6220 (standard error        0.13)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate      -2.9324 (standard error        0.10)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate      -2.4235 (standard error        0.13)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.8, two-sided p = 0.333

Test that all parameters are 0 : 
chi-squared = 2979.318, d.f. = 4, p &lt; 0.001

Estimated mean parameter  -2.7919 (s.e.   0.1614), two-sided p &lt; 0.001
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.3227
Test that variance of parameter is 0 :
Chi-squared =   27.0656 (d.f. = 3), p &lt; 0.001
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter  -2.7954 (s.e.   0.1405), two-sided p &lt; 0.001
0.95 level confidence interval [ -3.1427 , -2.4306 ]
Estimated standard deviation    0.2577 
0.95 level confidence interval [  0.1166 ,  0.6775 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =         0 (d.f. = 8), p = 1.000
Combination of left one-sided p-values:
Chi-squared =  3012.509 (d.f. = 8), p &lt; 0.001

--------------------------------------------------------------------------------
Parameter 3: eval : reciprocity
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       2.3902 (standard error        0.13)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       1.6849 (standard error        0.26)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       2.4027 (standard error        0.17)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       1.6312 (standard error        0.26)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.8, two-sided p = 0.333

Test that all parameters are 0 : 
chi-squared = 613.8601, d.f. = 4, p &lt; 0.001

Estimated mean parameter   2.0724 (s.e.   0.2122), two-sided p = 0.002
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.4244
Test that variance of parameter is 0 :
Chi-squared =   12.1538 (d.f. = 3), p = 0.007
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   2.0898 (s.e.   0.1793), two-sided p = 0.001
0.95 level confidence interval [  1.5865 ,  2.5149 ]
Estimated standard deviation     0.295 
0.95 level confidence interval [       0 ,  0.8727 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =  639.8221 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =         0 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 4: eval : transitive triplets
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.6644 (standard error        0.06)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.4889 (standard error        0.07)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.7559 (standard error        0.09)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.6344 (standard error        0.08)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared = 301.7613, d.f. = 4, p &lt; 0.001

Estimated mean parameter   0.6304 (s.e.   0.0549), two-sided p = 0.001
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.1098
Test that variance of parameter is 0 :
Chi-squared =    6.4731 (d.f. = 3), p = 0.091
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.6288 (s.e.   0.0467), two-sided p &lt; 0.001
0.95 level confidence interval [  0.5127 ,   0.753 ]
Estimated standard deviation    0.0571 
0.95 level confidence interval [       0 ,    0.22 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   326.301 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =         0 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 5: eval : 3-cycles
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -0.4685 (standard error        0.13)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -0.3216 (standard error        0.18)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate      -0.7416 (standard error        0.20)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate      -0.4651 (standard error        0.18)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared =  37.8092, d.f. = 4, p &lt; 0.001

Estimated mean parameter  -0.4824 (s.e.   0.0768), two-sided p = 0.008
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.1536
Test that variance of parameter is 0 :
Chi-squared =    2.5521 (d.f. = 3), p = 0.466
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter  -0.4824 (s.e.   0.0812), two-sided p = 0.010
0.95 level confidence interval [ -0.6633 , -0.3136 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.2927 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =    0.0792 (d.f. = 8), p = 1.000
Combination of left one-sided p-values:
Chi-squared =   54.4054 (d.f. = 8), p &lt; 0.001

--------------------------------------------------------------------------------
Parameter 6: eval : ah_pvt similarity
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.6474 (standard error        0.24)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.9429 (standard error        0.37)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.9396 (standard error        0.33)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.7482 (standard error        0.39)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared =  25.7413, d.f. = 4, p &lt; 0.001

Estimated mean parameter   0.7818 (s.e.    0.081), two-sided p = 0.002
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error     0.162
Test that variance of parameter is 0 :
Chi-squared =    0.7508 (d.f. = 3), p = 0.861
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.7818 (s.e.   0.1564), two-sided p = 0.015
0.95 level confidence interval [  0.4751 ,  1.1097 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.4542 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   41.3675 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =    0.0802 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 7: eval : age similarity
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -0.0497 (standard error        0.19)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       1.7286 (standard error        0.42)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       1.2576 (standard error        0.26)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       1.3274 (standard error        0.34)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =        1, two-sided p = 0.083

Test that all parameters are 0 : 
chi-squared =  56.0198, d.f. = 4, p &lt; 0.001

Estimated mean parameter   1.0169 (s.e.   0.3941), two-sided p = 0.082
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.7882
Test that variance of parameter is 0 :
Chi-squared =   30.3829 (d.f. = 3), p &lt; 0.001
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   1.0043 (s.e.   0.3517), two-sided p = 0.065
0.95 level confidence interval [  0.1597 ,  1.9231 ]
Estimated standard deviation    0.6341 
0.95 level confidence interval [  0.2956 ,  1.6637 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =    71.477 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =    1.8621 (d.f. = 8), p = 0.985

--------------------------------------------------------------------------------
Parameter 8: eval : same male
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.2841 (standard error        0.07)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.0924 (standard error        0.13)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.3966 (standard error        0.10)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.2883 (standard error        0.12)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared =  36.9989, d.f. = 4, p &lt; 0.001

Estimated mean parameter   0.2808 (s.e.   0.0565), two-sided p = 0.016
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.1131
Test that variance of parameter is 0 :
Chi-squared =    3.4271 (d.f. = 3), p = 0.330
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.2833 (s.e.   0.0489), two-sided p = 0.010
0.95 level confidence interval [  0.1603 ,  0.3909 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.2035 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   52.5821 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =    0.5578 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 9: eval : alcdrinkbeh similarity
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       1.6232 (standard error        0.71)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.6717 (standard error        0.54)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.4264 (standard error        0.38)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.8932 (standard error        0.55)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =        1, two-sided p = 0.083

Test that all parameters are 0 : 
chi-squared =  10.7244, d.f. = 4, p = 0.013

Estimated mean parameter   0.7344 (s.e.   0.2316), two-sided p = 0.050
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.4631
Test that variance of parameter is 0 :
Chi-squared =    2.3295 (d.f. = 3), p = 0.507
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.7344 (s.e.   0.2535), two-sided p = 0.063
0.95 level confidence interval [  0.2367 ,  1.3593 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.9042 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   23.5003 (d.f. = 8), p = 0.003
Combination of left one-sided p-values:
Chi-squared =    0.6398 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 10: rate : rate alcdrinkbeh period 1
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       6.2508 (standard error        1.03)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       1.8970 (standard error        0.78)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       5.1388 (standard error        1.27)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       4.7190 (standard error        1.97)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.2, two-sided p = 0.917

Test that all parameters are 0 : 
chi-squared =  65.0635, d.f. = 4, p &lt; 0.001

Estimated mean parameter   4.3543 (s.e.   1.0244), two-sided p = 0.024
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    2.0488
Test that variance of parameter is 0 :
Chi-squared =   12.9376 (d.f. = 3), p = 0.005
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   4.3377 (s.e.   0.9766), two-sided p = 0.021
0.95 level confidence interval [  2.0426 ,  6.8312 ]
Estimated standard deviation    1.5289 
0.95 level confidence interval [  0.4061 ,  4.3436 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   83.0214 (d.f. = 8), p &lt; 0.001
Combination of left one-sided p-values:
Chi-squared =    0.0317 (d.f. = 8), p = 1.000

--------------------------------------------------------------------------------
Parameter 11: eval : alcdrinkbeh linear shape
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -0.3628 (standard error        0.09)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -1.1139 (standard error        0.49)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate      -0.3858 (standard error        0.12)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate      -0.6328 (standard error        0.21)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =       -1, two-sided p = 0.083

Test that all parameters are 0 : 
chi-squared =  40.5536, d.f. = 4, p &lt; 0.001

Estimated mean parameter  -0.4526 (s.e.   0.1063), two-sided p = 0.024
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.2125
Test that variance of parameter is 0 :
Chi-squared =    3.4839 (d.f. = 3), p = 0.323
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter  -0.4132 (s.e.   0.0679), two-sided p = 0.009
0.95 level confidence interval [ -0.6298 , -0.2801 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.2877 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =    0.0268 (d.f. = 8), p = 1.000
Combination of left one-sided p-values:
Chi-squared =    57.608 (d.f. = 8), p &lt; 0.001

--------------------------------------------------------------------------------
Parameter 12: eval : alcdrinkbeh quadratic shape
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.0045 (standard error        0.02)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.5294 (standard error        0.54)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.0332 (standard error        0.03)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0507 (standard error        0.05)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =        1, two-sided p = 0.083

Test that all parameters are 0 : 
chi-squared =   2.8786, d.f. = 4, p = 0.411

Estimated mean parameter   0.0178 (s.e.   0.0165), two-sided p = 0.360
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error     0.033
Test that variance of parameter is 0 :
Chi-squared =    1.8578 (d.f. = 3), p = 0.602
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.0178 (s.e.   0.0176), two-sided p = 0.387
0.95 level confidence interval [ -0.0175 ,  0.0656 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,   0.064 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   12.5311 (d.f. = 8), p = 0.129
Combination of left one-sided p-values:
Chi-squared =    2.1752 (d.f. = 8), p = 0.975

--------------------------------------------------------------------------------
Parameter 13: eval : alcdrinkbeh max. alter
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.0133 (standard error        0.07)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.3070 (standard error        0.45)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate      -0.1452 (standard error        0.12)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0674 (standard error        0.18)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.8, two-sided p = 0.333

Test that all parameters are 0 : 
chi-squared =   2.0926, d.f. = 4, p = 0.553

Estimated mean parameter   -0.014 (s.e.   0.0582), two-sided p = 0.826
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.1164
Test that variance of parameter is 0 :
Chi-squared =    2.0368 (d.f. = 3), p = 0.565
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   -0.014 (s.e.   0.0591), two-sided p = 0.828
0.95 level confidence interval [ -0.1557 ,  0.1289 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.2326 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =    6.8084 (d.f. = 8), p = 0.557
Combination of left one-sided p-values:
Chi-squared =    6.9042 (d.f. = 8), p = 0.547

--------------------------------------------------------------------------------
Parameter 14: eval : alcdrinkbeh: effect from ah_pvt
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -0.0026 (standard error        0.01)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -0.0385 (standard error        0.03)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.0097 (standard error        0.01)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0198 (standard error        0.01)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.2, two-sided p = 0.917

Test that all parameters are 0 : 
chi-squared =   4.8712, d.f. = 4, p = 0.181

Estimated mean parameter   0.0038 (s.e.   0.0082), two-sided p = 0.675
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.0165
Test that variance of parameter is 0 :
Chi-squared =    4.7381 (d.f. = 3), p = 0.192
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.0015 (s.e.   0.0042), two-sided p = 0.738
0.95 level confidence interval [ -0.0092 ,  0.0167 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.0238 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   10.0287 (d.f. = 8), p = 0.263
Combination of left one-sided p-values:
Chi-squared =    7.1317 (d.f. = 8), p = 0.522

--------------------------------------------------------------------------------
Parameter 15: eval : alcdrinkbeh: effect from age
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate      -0.0362 (standard error        0.11)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate       0.0798 (standard error        0.17)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate      -0.0004 (standard error        0.05)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0759 (standard error        0.07)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =      0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared =   1.5047, d.f. = 4, p = 0.681

Estimated mean parameter   0.0223 (s.e.   0.0266), two-sided p = 0.463
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.0532
Test that variance of parameter is 0 :
Chi-squared =    1.1763 (d.f. = 3), p = 0.759
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.0223 (s.e.   0.0389), two-sided p = 0.607
0.95 level confidence interval [ -0.0593 ,  0.1071 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.1275 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =    8.4925 (d.f. = 8), p = 0.387
Combination of left one-sided p-values:
Chi-squared =    4.4877 (d.f. = 8), p = 0.811

--------------------------------------------------------------------------------
Parameter 16: eval : alcdrinkbeh: effect from parentdrkfrq
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.0130 (standard error        0.04)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -0.1119 (standard error        0.35)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.1426 (standard error        0.10)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0674 (standard error        0.12)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =     -0.4, two-sided p = 0.750

Test that all parameters are 0 : 
chi-squared =   2.5853, d.f. = 4, p = 0.460

Estimated mean parameter   0.0367 (s.e.   0.0377), two-sided p = 0.402
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error    0.0754
Test that variance of parameter is 0 :
Chi-squared =    1.6974 (d.f. = 3), p = 0.638
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.0345 (s.e.   0.0366), two-sided p = 0.416
0.95 level confidence interval [ -0.0427 ,  0.1488 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,  0.1532 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   10.5681 (d.f. = 8), p = 0.227
Combination of left one-sided p-values:
Chi-squared =     3.738 (d.f. = 8), p = 0.880

--------------------------------------------------------------------------------
Parameter 17: eval : alcdrinkbeh: effect from tobacco
--------------------------------------------------------------------------------
Data set 1, AlcoholBehavior(ans.5809) :  Estimate       0.4565 (standard error        0.17)
Data set 2, AlcoholBehavior(ans.88)   :  Estimate      -0.0197 (standard error        0.72)
Data set 3, AlcoholBehavior(ans.7)    :  Estimate       0.3567 (standard error        0.21)
Data set 4, AlcoholBehavior(ans.8)    :  Estimate       0.0612 (standard error        0.26)

 4 datasets used.

IWLS modification of Snijders-Baerveldt (2003) method  of combining estimates
-----------------------------------------------------------------------------
This method assumes that true parameters and standard errors are uncorrelated.
This can be checked by the plot method and the test below.

Test that estimates and standard errors are uncorrelated: 
Spearman's rank correlation rho =       -1, two-sided p = 0.083

Test that all parameters are 0 : 
chi-squared =  10.5466, d.f. = 4, p = 0.014

Estimated mean parameter   0.3354 (s.e.    0.099), two-sided p = 0.043
based on IWLS modification of Snijders &amp; Baerveldt (2003). 

Residual standard error     0.198
Test that variance of parameter is 0 :
Chi-squared =    1.9346 (d.f. = 3), p = 0.586
based on IWLS modification of Snijders &amp; Baerveldt (2003).

Estimates and confidence intervals under normality assumptions
------------------------------------------------------- -------
Estimated mean parameter   0.3354 (s.e.   0.1143), two-sided p = 0.061
0.95 level confidence interval [  0.0379 ,  0.5654 ]
Estimated standard deviation  &lt; 0.0001 
0.95 level confidence interval [       0 ,   0.424 ]

Fisher's combination of one-sided tests
----------------------------------------
Combination of right one-sided p-values:
Chi-squared =   21.0486 (d.f. = 8), p = 0.007
Combination of left one-sided p-values:
Chi-squared =    2.5647 (d.f. = 8), p = 0.959</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="exponential-random-graphs" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> Exponential Random Graphs</h1>
<section id="lazega-example" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="lazega-example"><span class="header-section-number">31.1</span> Lazega example</h2>
<p>From Statistical Analysis of Networks with R</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-14_edb53c58380d4bb927baf383987e7d1e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># igraph example</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lazega)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lazega, <span class="at">layout =</span> layout_with_kk, <span class="at">vertex.label =</span> <span class="fu">V</span>(lazega),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The statnet representation of</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-15_8613fad12c052288604e1b7b4a1eef13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making statnet version of network data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">get.adjacency</span>(lazega)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>as(&lt;dsCMatrix&gt;, "dgCMatrix") is deprecated since Matrix 1.5-0; do as(., "generalMatrix") instead</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>v.attrs <span class="ot">&lt;-</span> <span class="fu">get.data.frame</span>(lazega, <span class="at">what=</span> <span class="st">"vertices"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>lazega.s <span class="ot">&lt;-</span> <span class="fu">as.network</span>(<span class="fu">as.matrix</span>(A), <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>network<span class="sc">::</span><span class="fu">set.vertex.attribute</span>(lazega.s, <span class="st">"office"</span>, v.attrs<span class="sc">$</span>Office)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>network<span class="sc">::</span><span class="fu">set.vertex.attribute</span>(lazega.s, <span class="st">"practice"</span>, v.attrs<span class="sc">$</span>Practice)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>network<span class="sc">::</span><span class="fu">set.vertex.attribute</span>(lazega.s, <span class="st">"gender"</span>, v.attrs<span class="sc">$</span>Gender)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>network<span class="sc">::</span><span class="fu">set.vertex.attribute</span>(lazega.s, <span class="st">"seniority"</span>, v.attrs<span class="sc">$</span>Seniority)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-16_17e453ffc1763811acae9f838b84c3ef">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ergm_deg <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> <span class="fu">degree</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span> triangles) </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_deg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> degree1  degree2  degree3  degree4  degree5  degree6  degree7  degree8 
       3        2        4        2        4        4        1        1 
triangle 
     120 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">degree_distribution</span>(lazega) <span class="sc">*</span> <span class="fu">vcount</span>(lazega)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 3 2 4 2 4 4 1 1 5 1 1 2 3 0 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">degreedist</span>(lazega.s) <span class="co"># statnet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> degree0  degree1  degree2  degree3  degree4  degree5  degree6  degree7 
       2        3        2        4        2        4        4        1 
 degree8  degree9 degree10 degree11 degree12 degree13 degree15 
       1        5        1        1        2        3        1 </code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-17_96f52aabef67fa387ea86bbc06478abb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mixing matrix - how many ties are between each for each attribute</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mixingmatrix</span>(lazega.s, <span class="st">"gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   1  2
1 98 16
2 16  1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note:  Marginal totals can be misleading for undirected mixing matrices.</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-18_64a8d04be3d372bfb1ad5a90c9b06843">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bernoulli ERGM</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ergm_bern_form <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> edges)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_bern_form)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>edges 
  115 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ergm_bern <span class="ot">&lt;-</span> <span class="fu">ergm</span>(ergm_bern_form)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_bern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = ergm_bern_form)

Maximum Likelihood Results:

      Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges  -1.4992     0.1031      0  -14.54   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 873.4  on 630  degrees of freedom
 Residual Deviance: 598.8  on 629  degrees of freedom
 
AIC: 600.8  BIC: 605.2  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-19_ef0cebd3cc37d63f20031ae58e19d3c7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.499</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.499</span> )) <span class="co"># this is also the density of the network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1825747</code></pre>
</div>
</div>
<p>The interpretation of this “edges” network means, that if we were to try to estimate the probability of the existence of an edge by just the number of edges in the model, we should expect a uniform distribution of the edges</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-20_54a0312c3a2657f4f77a7425789bd984">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating from ergm</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sim_bern <span class="ot">&lt;-</span> <span class="fu">simulate</span>(ergm_bern, <span class="at">burnin =</span> <span class="fl">1e+6</span>, <span class="at">seed =</span> <span class="dv">9</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">degreedist</span>(sim_bern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> degree3  degree4  degree5  degree6  degree7  degree8  degree9 degree10 
       2        8        1        5        6        9        1        2 
degree11 
       2 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">degreedist</span>(lazega.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> degree0  degree1  degree2  degree3  degree4  degree5  degree6  degree7 
       2        3        2        4        2        4        4        1 
 degree8  degree9 degree10 degree11 degree12 degree13 degree15 
       1        5        1        1        2        3        1 </code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-21_3af06b6026f31da54b40073b13aecff9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate with triangles</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>ergm_tri_form <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> triangle)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_tri_form)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>triangle 
     120 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ergm_tri <span class="ot">&lt;-</span> <span class="fu">ergm</span>(ergm_tri_form)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'glpk' selected as the solver, but package 'Rglpk' is not available;
falling back to 'lpSolveAPI'. This should be fine unless the sample size and/or
the number of parameters is very big.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sim_tri <span class="ot">&lt;-</span> <span class="fu">simulate</span>(ergm_tri)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_tri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_tri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = ergm_tri_form)

Monte Carlo Maximum Likelihood Results:

         Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
triangle -0.38428    0.05762      0  -6.669   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 873.4  on 630  degrees of freedom
 Residual Deviance: 733.1  on 629  degrees of freedom
 
AIC: 735.1  BIC: 739.5  (Smaller is better. MC Std. Err. = 1.988)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.38937</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.38937</span>)) <span class="co"># p = .403</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.403869</code></pre>
</div>
</div>
<p>.403 should loosely translate to the density of triangles, but I don’t know how.</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-22_9f28a649be2e43dce9c7343d850020e8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complex with k stars</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ergm_complex <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">kstar</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">kstar</span>(<span class="dv">3</span>) <span class="sc">+</span> triangle)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_complex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   edges   kstar2   kstar3 triangle 
     115      926     2681      120 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternating kstar statistic</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ergm_geometric <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">gwesp</span>(<span class="dv">1</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_geometric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        edges gwesp.fixed.1 
     115.0000      213.1753 </code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-23_b58d4efde73391ab995d9afde79d9578">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ergm_lazega <span class="ot">&lt;-</span> <span class="fu">formula</span>(lazega.s <span class="sc">~</span> edges <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">gwesp</span>(<span class="fu">log</span>(<span class="dv">3</span>), <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">nodemain</span>(<span class="st">"seniority"</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">nodemain</span>(<span class="st">"practice"</span>) <span class="sc">+</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">match</span>(<span class="st">"practice"</span>) <span class="sc">+</span> <span class="co"># dyads that link same practice</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">match</span>(<span class="st">"gender"</span>) <span class="sc">+</span> <span class="co"># dyads that link same gender</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">match</span>(<span class="st">"office"</span>))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_lazega)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       edges gwesp.fixed.1.09861228866811 
                    115.0000                     222.9108 
           nodecov.seniority             nodecov.practice 
                   4687.0000                     359.0000 
          nodematch.practice             nodematch.gender 
                     72.0000                      99.0000 
            nodematch.office 
                     85.0000 </code></pre>
</div>
</div>
<p>Types of structural components</p>
<ul>
<li><p>“geometrically weighted degree count”</p></li>
<li><p>“Alternating sums of k-triangles”</p></li>
<li><p>“Alternating k-star statistic”</p></li>
</ul>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-24_298261adb178eb42ec12fd92a2105f27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ERGM fitting</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ergm_lazega_fit <span class="ot">&lt;-</span> <span class="fu">ergm</span>(ergm_lazega)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ergm_lazega_fit) <span class="co"># overall fit based on deviance statistic i guess</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: lazega.s ~ edges + gwesp(log(3), fixed = TRUE) + nodemain("seniority") + 
    nodemain("practice") + match("practice") + match("gender") + 
    match("office")
         Df Deviance Resid. Df Resid. Dev Pr(&gt;|Chisq|)    
NULL                       630     873.37                 
Model 1:  7    413.8       623     459.57    &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ergm_lazega_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = ergm_lazega)

Monte Carlo Maximum Likelihood Results:

                             Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges                        -6.97916    0.68461      0 -10.194  &lt; 1e-04 ***
gwesp.fixed.1.09861228866811  0.59367    0.09150      0   6.488  &lt; 1e-04 ***
nodecov.seniority             0.02431    0.00635      0   3.828 0.000129 ***
nodecov.practice              0.39029    0.11452      0   3.408 0.000655 ***
nodematch.practice            0.76953    0.19477      0   3.951  &lt; 1e-04 ***
nodematch.gender              0.72433    0.25253      0   2.868 0.004127 ** 
nodematch.office              1.16433    0.19854      0   5.864  &lt; 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 873.4  on 630  degrees of freedom
 Residual Deviance: 459.6  on 623  degrees of freedom
 
AIC: 473.6  BIC: 504.7  (Smaller is better. MC Std. Err. = 0.3342)</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-25_c1f05df94216e284c0eb6c3f3e3d91a0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># goodness of fit</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>ergm_lazega_gof <span class="ot">&lt;-</span> <span class="fu">gof</span>(ergm_lazega_fit)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ergm_lazega_gof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The way goodness of fit is currently conducted is by generating a bunch of network statistics and seeing if they fit the simulated distribution.</p>
</section>
</section>
<section id="linear-regression-w-matrices" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> Linear Regression w/ Matrices</h1>
<p>Section follows <a href="https://dshizuka.github.io/networkanalysis/07_mrqap.html">Dai Shizuka’s Intro to MRQAP</a></p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-26_1d49b7c05b8cce7da728bc2cfac25321">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random matrices</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">=</span><span class="fu">rgraph</span>(<span class="dv">10</span>, <span class="at">m=</span><span class="dv">1</span>, <span class="at">tprob=</span><span class="fl">0.5</span>, <span class="at">mode=</span><span class="st">"graph"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">=</span><span class="fu">rgraph</span>(<span class="dv">10</span>, <span class="at">m=</span><span class="dv">1</span>, <span class="at">tprob=</span><span class="fl">0.5</span>, <span class="at">mode=</span><span class="st">"graph"</span>) </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">=</span><span class="fu">rgraph</span>(<span class="dv">10</span>, <span class="at">m=</span><span class="dv">1</span>, <span class="at">tprob=</span><span class="fl">0.5</span>, <span class="at">mode=</span><span class="st">"graph"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-27_eb1b06a48a1f06e95ba25c45a7550658">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mod_net <span class="ot">&lt;-</span> <span class="fu">netlm</span>(m1, m2 <span class="sc">+</span> m3, <span class="at">mode =</span> <span class="st">"graph"</span>, <span class="at">nullhyp =</span> <span class="st">"qap"</span>, <span class="at">test.statistic =</span> <span class="st">"t-value"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
OLS Network Model

Residuals:
        0%        25%        50%        75%       100% 
-0.6245211 -0.5383142  0.3754789  0.4616858  0.5478927 

Coefficients:
            Estimate   Pr(&lt;=b) Pr(&gt;=b) Pr(&gt;=|b|)
(intercept)  0.6245211 1.000   0.000   0.000    
x1          -0.0862069 0.206   0.798   0.405    

Residual standard error: 0.5044 on 43 degrees of freedom
Multiple R-squared: 0.01552     Adjusted R-squared: -0.007378 
F-statistic: 0.6778 on 1 and 43 degrees of freedom, p-value: 0.4149 


Test Diagnostics:

    Null Hypothesis: qap 
    Replications: 1000 
    Coefficient Distribution Summary:

       (intercept)         x1
Min     -5.082e-01 -3.177e+00
1stQ     1.708e+00 -8.233e-01
Median   2.298e+00 -2.184e-16
Mean     2.350e+00  1.370e-02
3rdQ     2.935e+00  8.233e-01
Max      5.194e+00  5.220e+00</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-28_4332c0c66be7ca92e48de969b99d4ad9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recreating netlm</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> m1[<span class="fu">upper.tri</span>(m1)]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (m2<span class="sc">+</span>m3)[<span class="fu">upper.tri</span>(m1)]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.6245 -0.5383  0.3755  0.4617  0.5479 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.62452    0.11256   5.548 1.65e-06 ***
x           -0.08621    0.10471  -0.823    0.415    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5044 on 43 degrees of freedom
Multiple R-squared:  0.01552,   Adjusted R-squared:  -0.007378 
F-statistic: 0.6778 on 1 and 43 DF,  p-value: 0.4149</code></pre>
</div>
</div>
<p>It seems that <code>netlm</code> is simply vectorizing the upper triangle of the matrix and running lm. In this case, they have 1 response and 1 covariate matrix. There is some additional output for the coefficient distribution.</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-29_7a5da7470e4b3991ff3a9ca41cfec8e2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mrqap.dsp</span>(m1<span class="sc">~</span>m2<span class="sc">+</span>m3, <span class="at">directed =</span> <span class="st">"undirected"</span>, <span class="at">randomisations =</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MRQAP with Double-Semi-Partialing (DSP)

Formula:  m1 ~ m2 + m3 

Coefficients:
          Estimate    P(β&gt;=r) P(β&lt;=r) P(|β|&lt;=|r|)
intercept  0.62001925 0.9983  0.0017  0.0017     
m2         0.05813282 0.6343  0.3657  0.7110     
m3        -0.23561116 0.0664  0.9336  0.1506     

Residual standard error: 0.5002 on 42 degrees of freedom
F-statistic: 1.202 on 2 and 42 degrees of freedom, p-value: 0.3106 
Multiple R-squared: 0.05416     Adjusted R-squared: 0.00912 
AIC: -40.77726 </code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-30_280903a1f5d2975eac969c96e7c68e24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same thing, but with additional regressor.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> m1[<span class="fu">upper.tri</span>(m1)]</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> m2[<span class="fu">upper.tri</span>(m2)]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> m3[<span class="fu">upper.tri</span>(m3)]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>manual_mrqap <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manual_mrqap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.6782 -0.4425  0.3219  0.3800  0.6156 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.62002    0.11169   5.551 1.75e-06 ***
x1           0.05813    0.15142   0.384    0.703    
x2          -0.23561    0.15425  -1.527    0.134    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5002 on 42 degrees of freedom
Multiple R-squared:  0.05416,   Adjusted R-squared:  0.00912 
F-statistic: 1.202 on 2 and 42 DF,  p-value: 0.3106</code></pre>
</div>
</div>
<p>For the additional “testing of null hypothesis” version, see the paper references, but it involves first regressing on other covariates to “take out the effect”, Now we use the residuals in place of the original covariate and shuffle them for the permutation test. It’s unclear that there is any structure to the permutations.</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-31_d46203114b9e2311dc284ea35d4dcb34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first pval for x1</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x1_resid <span class="ot">&lt;-</span> <span class="fu">lm</span>(x1<span class="sc">~</span>x2)<span class="sc">$</span>residuals</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>num_random <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> num_random)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_random) {</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  x1_resid_shuf <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1_resid, <span class="fu">length</span>(x1_resid))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  betas[i] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1_resid_shuf <span class="sc">+</span> x2)<span class="sc">$</span>coef[<span class="st">"x1_resid_shuf"</span>]</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(betas <span class="sc">&lt;=</span> <span class="fl">0.05813</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6494</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-32_4f0d4ffe1c7abe09f502231671c610a9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># second pval for x2</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>x2_resid <span class="ot">&lt;-</span> <span class="fu">lm</span>(x2<span class="sc">~</span>x1)<span class="sc">$</span>residuals</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>y2_resid <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1)<span class="sc">$</span>residuals</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2_resid) <span class="co"># beta coefficient is the same</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2_resid)

Coefficients:
(Intercept)           x1     x2_resid  
    0.53846      0.04049     -0.23561  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # lm(y2_resid ~ x2_resid) # beta coefficient is the same</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm(y~x1+x2) # beta coef in original.</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>num_random <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> num_random)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_random) {</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  x2_resid_shuf <span class="ot">&lt;-</span> <span class="fu">sample</span>(x2_resid, <span class="fu">length</span>(x2_resid))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  betas[i] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1 <span class="sc">+</span> x2_resid_shuf)<span class="sc">$</span>coef[<span class="st">"x2_resid_shuf"</span>]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(betas <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fl">0.23561</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0665</code></pre>
</div>
</div>
<section id="resources-1" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="resources-1"><span class="header-section-number">32.1</span> Resources</h2>
<ul>
<li><a href="https://dshizuka.github.io/networkanalysis/07_mrqap.html">Intro to Network Regression</a></li>
</ul>
</section>
<section id="qap-with-correlation" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="qap-with-correlation"><span class="header-section-number">32.2</span> QAP with correlation</h2>
<p>Match results from “QAP Partialling as a test of spuriousness, Krackhardt (1987)”.</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-33_9c288e20b4de5ba33726cfcaa481ab54">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> T)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> T)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">c</span>(m1[<span class="fu">upper.tri</span>(m1)]), <span class="fu">c</span>(m2[<span class="fu">upper.tri</span>(m2)])) <span class="co"># matches paper</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8164966</code></pre>
</div>
</div>
</section>
</section>
<section id="permuting-matrices" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Permuting matrices</h1>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-34_003746e0dfcf604ea3d27fcb1badd6fc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pmatrix from Matrix package, creates the permutation matrix based on a vector</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>(mm <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>)), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]
[1,] -0.04  1.19  0.46
[2,]  0.05  0.94  0.48
[3,] -0.73 -0.59 -1.37</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(pm1 <span class="ot">&lt;-</span> <span class="fu">as</span>(<span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>)), <span class="st">"pMatrix"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3 x 3 sparse Matrix of class "pMatrix"
          
[1,] . | .
[2,] . . |
[3,] | . .</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>mm <span class="sc">%*%</span> pm1 <span class="co"># permute cols</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3 x 3 Matrix of class "dgeMatrix"
      [,1]  [,2]  [,3]
[1,]  0.46 -0.04  1.19
[2,]  0.48  0.05  0.94
[3,] -1.37 -0.73 -0.59</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>pm1 <span class="sc">%*%</span> mm <span class="co"># permute rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3 x 3 Matrix of class "dgeMatrix"
      [,1]  [,2]  [,3]
[1,]  0.05  0.94  0.48
[2,] -0.73 -0.59 -1.37
[3,] -0.04  1.19  0.46</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mm[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)] <span class="co"># permute both row &amp; col</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]
[1,]  0.94  0.48  0.05
[2,] -0.59 -1.37 -0.73
[3,]  1.19  0.46 -0.04</code></pre>
</div>
</div>
</section>
<section id="network-block-models" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Network Block Models</h1>
<p>Analagous to classic mixture models, and used to fit stochastic block models</p>
<p><span class="math display">
\begin{aligned}
\mathbb{P}_\theta (Y = y) = \frac{1}{\kappa}\exp \left\{\sum_{q,r} \theta_{qr}L_{qr}(y)\right\}
\end{aligned}
</span> where <span class="math inline">L_{qr}(y)</span> is the number of edges in the observed graph <span class="math inline">y</span> connecting pairs of vertices of classes between <span class="math inline">q</span> and <span class="math inline">r</span>.</p>
<p>Algorithmically, the EM algorithm is a natural choice here.</p>
<p>Unfortunately, couldn’t get mixer to work because it errored out in installation.</p>
</section>
<section id="latent-network-models" class="level1" data-number="35">
<h1 data-number="35"><span class="header-section-number">35</span> Latent Network Models</h1>
<p>Loosely speaking, latent network models extract the eigenspace of relational data, essentially the eigen decomposition of the symmetric adjacency matrix. We follow Kolacyzk’s statistical analysis of network data in this section.</p>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-36_c3ac87353ddfb51c395f06e679f071a0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># for mcmc sampling</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>laz_A <span class="ot">&lt;-</span> <span class="fu">get.adjacency</span>(lazega, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-37_2fde0933a7dda4f2279bf8f6159dbad5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base fit</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>lazega_leig_fit1 <span class="ot">&lt;-</span> <span class="fu">eigenmodel_mcmc</span>(laz_A, <span class="at">R =</span> <span class="dv">2</span>, <span class="at">S =</span> <span class="dv">11000</span>, <span class="at">burn =</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5 percent done (iteration 1050) Mon Dec 19 20:52:33 2022
10 percent done (iteration 2100) Mon Dec 19 20:52:36 2022
15 percent done (iteration 3150) Mon Dec 19 20:52:39 2022
20 percent done (iteration 4200) Mon Dec 19 20:52:43 2022
25 percent done (iteration 5250) Mon Dec 19 20:52:46 2022
30 percent done (iteration 6300) Mon Dec 19 20:52:49 2022
35 percent done (iteration 7350) Mon Dec 19 20:52:52 2022
40 percent done (iteration 8400) Mon Dec 19 20:52:56 2022
45 percent done (iteration 9450) Mon Dec 19 20:52:59 2022
50 percent done (iteration 10500) Mon Dec 19 20:53:03 2022
55 percent done (iteration 11550) Mon Dec 19 20:53:06 2022
60 percent done (iteration 12600) Mon Dec 19 20:53:09 2022
65 percent done (iteration 13650) Mon Dec 19 20:53:12 2022
70 percent done (iteration 14700) Mon Dec 19 20:53:16 2022
75 percent done (iteration 15750) Mon Dec 19 20:53:19 2022
80 percent done (iteration 16800) Mon Dec 19 20:53:23 2022
85 percent done (iteration 17850) Mon Dec 19 20:53:26 2022
90 percent done (iteration 18900) Mon Dec 19 20:53:29 2022
95 percent done (iteration 19950) Mon Dec 19 20:53:32 2022
100 percent done (iteration 21000) Mon Dec 19 20:53:36 2022</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-38_104df41f4045f60549c537ba53807389">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same practice regressor</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>v_attr_df <span class="ot">&lt;-</span> <span class="fu">get.data.frame</span>(lazega, <span class="at">what =</span> <span class="st">"vertices"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>same_prac_op <span class="ot">&lt;-</span> v_attr_df<span class="sc">$</span>Practice <span class="sc">%o%</span> v_attr_df<span class="sc">$</span>Practice <span class="co"># outer product of all ties</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># possible values are 1:3, so squared values are equality,</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>same_prac <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(same_prac_op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>)), <span class="dv">36</span>, <span class="dv">36</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># regressors into array</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>leig_X <span class="ot">&lt;-</span> <span class="fu">array</span>(same_prac, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">36</span>, <span class="dv">1</span>))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># model w/ practice as regressor</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>lazega_leig_fit2 <span class="ot">&lt;-</span> <span class="fu">eigenmodel_mcmc</span>(laz_A, leig_X, <span class="at">R =</span> <span class="dv">2</span>, <span class="at">S =</span> <span class="dv">11000</span>, <span class="at">burn =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5 percent done (iteration 600) Mon Dec 19 20:53:38 2022
10 percent done (iteration 1200) Mon Dec 19 20:53:40 2022
15 percent done (iteration 1800) Mon Dec 19 20:53:42 2022
20 percent done (iteration 2400) Mon Dec 19 20:53:44 2022
25 percent done (iteration 3000) Mon Dec 19 20:53:46 2022
30 percent done (iteration 3600) Mon Dec 19 20:53:48 2022
35 percent done (iteration 4200) Mon Dec 19 20:53:50 2022
40 percent done (iteration 4800) Mon Dec 19 20:53:52 2022
45 percent done (iteration 5400) Mon Dec 19 20:53:54 2022
50 percent done (iteration 6000) Mon Dec 19 20:53:56 2022
55 percent done (iteration 6600) Mon Dec 19 20:53:58 2022
60 percent done (iteration 7200) Mon Dec 19 20:54:00 2022
65 percent done (iteration 7800) Mon Dec 19 20:54:02 2022
70 percent done (iteration 8400) Mon Dec 19 20:54:04 2022
75 percent done (iteration 9000) Mon Dec 19 20:54:06 2022
80 percent done (iteration 9600) Mon Dec 19 20:54:08 2022
85 percent done (iteration 10200) Mon Dec 19 20:54:10 2022
90 percent done (iteration 10800) Mon Dec 19 20:54:12 2022
95 percent done (iteration 11400) Mon Dec 19 20:54:14 2022
100 percent done (iteration 12000) Mon Dec 19 20:54:16 2022</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-39_56a11740e8247976de7402dfe4553a23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same office - create regression matrix</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>same_off_op <span class="ot">&lt;-</span> v_attr_df<span class="sc">$</span>Office <span class="sc">%o%</span> v_attr_df<span class="sc">$</span>Office</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>same_off <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(same_off_op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>)), <span class="dv">36</span>, <span class="dv">36</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>same_off <span class="ot">&lt;-</span> <span class="fu">array</span>(same_off, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">36</span>, <span class="dv">1</span>))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>leig_X <span class="ot">&lt;-</span> <span class="fu">array</span>(same_off, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">36</span>, <span class="dv">1</span>))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>lazega_leig_fit3 <span class="ot">&lt;-</span> <span class="fu">eigenmodel_mcmc</span>(laz_A, leig_X, <span class="at">R =</span> <span class="dv">2</span>, <span class="at">S =</span> <span class="dv">3000</span>, <span class="at">burn =</span> <span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5 percent done (iteration 400) Mon Dec 19 20:54:18 2022
10 percent done (iteration 800) Mon Dec 19 20:54:19 2022
15 percent done (iteration 1200) Mon Dec 19 20:54:20 2022
20 percent done (iteration 1600) Mon Dec 19 20:54:22 2022
25 percent done (iteration 2000) Mon Dec 19 20:54:23 2022
30 percent done (iteration 2400) Mon Dec 19 20:54:24 2022
35 percent done (iteration 2800) Mon Dec 19 20:54:26 2022
40 percent done (iteration 3200) Mon Dec 19 20:54:27 2022
45 percent done (iteration 3600) Mon Dec 19 20:54:29 2022
50 percent done (iteration 4000) Mon Dec 19 20:54:30 2022
55 percent done (iteration 4400) Mon Dec 19 20:54:31 2022
60 percent done (iteration 4800) Mon Dec 19 20:54:33 2022
65 percent done (iteration 5200) Mon Dec 19 20:54:34 2022
70 percent done (iteration 5600) Mon Dec 19 20:54:36 2022
75 percent done (iteration 6000) Mon Dec 19 20:54:37 2022
80 percent done (iteration 6400) Mon Dec 19 20:54:39 2022
85 percent done (iteration 6800) Mon Dec 19 20:54:40 2022
90 percent done (iteration 7200) Mon Dec 19 20:54:41 2022
95 percent done (iteration 7600) Mon Dec 19 20:54:43 2022
100 percent done (iteration 8000) Mon Dec 19 20:54:44 2022</code></pre>
</div>
</div>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-40_89b005afee18741b4a73d5e55cda37cb">

</div>
<p>Below are the 3 latent variable spaces based on</p>
<ol type="1">
<li>base regression</li>
<li>same practice</li>
<li>same office</li>
</ol>
<div class="cell" data-hash="social_network_cache/html/unnamed-chunk-41_449bab0f40028c82c0adaeaffab45054">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lazega, <span class="at">layout =</span> leig_lat_1,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> v_colors,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape =</span> v_shapes,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> v_size,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> v_label)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lazega, <span class="at">layout =</span> leig_lat_2,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> v_colors,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape =</span> v_shapes,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> v_size,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> v_label)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lazega, <span class="at">layout =</span> leig_lat_3,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> v_colors,</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape =</span> v_shapes,</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> v_size,</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> v_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="social_network_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../plant_breeding/plant_breeding.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Plant Breeding</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../spatial/carbayes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">CARBayes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>