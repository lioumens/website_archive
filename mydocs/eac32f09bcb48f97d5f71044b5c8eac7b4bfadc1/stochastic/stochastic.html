<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.203">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Liou">

<title>Personal Documentation - 31&nbsp; Stochastic</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../timeseries/timeseries.html" rel="next">
<link href="../spatial/spatial.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stochastic</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Documentation</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Front Page</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../advanced/advanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Advanced R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approximation/approximation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Approximation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bayesian/bayesian.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../categorical/categorical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../changepoint/changepoint.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Changepoint Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../crossover/crossover.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Crossover Designs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../diffeq/diffeq.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Differential Equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../epidemiology/epidemiology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Epidemiology</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../experimentaldesign/experimentaldesign.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Experimental Design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exponential/exponential.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exponential Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../gam/gam.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Generalized Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/longitudinal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Longitudinal Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/randomcoef.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Random Coefficient Models (CALS)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../longitudinal/within_between.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Within-Between Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrix/matrix.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Matrix Math</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../meta/meta.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Meta Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mixed/mixed.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Mixed Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mixed/mixed_variance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Mixed Models (Variance)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../network/network_centrality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Network Centrality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../network/network_gnar.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">GNAR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../next_gen_sequencing/next_gen_sequencing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Next Generation Sequencing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../observable/observable.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Observable Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../optimization/optimization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Optimization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ordination/ordination.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Ordination</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallel/parallel.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Parallel Computing in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plant_breeding/plant_breeding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Plant Breeding</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../social_network/social_network.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Social Network Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../spatial/carbayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">CARBayes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../spatial/spatial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Spatial Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic/stochastic.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stochastic</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../timeseries/timeseries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Time Series</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Draft</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bootstrap/bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../causal/causal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Causal Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sensitivity/sensitivity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Sensitivity Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../signal/signal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Signal Processing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../color/color.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Colors in R</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#gamblers-ruin" id="toc-gamblers-ruin" class="nav-link active" data-scroll-target="#gamblers-ruin"><span class="toc-section-number">31.1</span>  Gamblers Ruin</a></li>
  <li><a href="#stochastic-processes" id="toc-stochastic-processes" class="nav-link" data-scroll-target="#stochastic-processes"><span class="toc-section-number">31.2</span>  Stochastic Processes</a>
  <ul class="collapse">
  <li><a href="#wiener-process" id="toc-wiener-process" class="nav-link" data-scroll-target="#wiener-process"><span class="toc-section-number">31.2.1</span>  Wiener Process</a></li>
  <li><a href="#ornstein-uhlenbeck-process" id="toc-ornstein-uhlenbeck-process" class="nav-link" data-scroll-target="#ornstein-uhlenbeck-process"><span class="toc-section-number">31.2.2</span>  Ornstein-Uhlenbeck Process</a></li>
  <li><a href="#general-linear-sde" id="toc-general-linear-sde" class="nav-link" data-scroll-target="#general-linear-sde"><span class="toc-section-number">31.2.3</span>  General Linear SDE</a></li>
  </ul></li>
  <li><a href="#simulating-stochastic-differential-equations" id="toc-simulating-stochastic-differential-equations" class="nav-link" data-scroll-target="#simulating-stochastic-differential-equations"><span class="toc-section-number">31.3</span>  Simulating Stochastic Differential Equations</a></li>
  <li><a href="#guassian-markov-random-field" id="toc-guassian-markov-random-field" class="nav-link" data-scroll-target="#guassian-markov-random-field"><span class="toc-section-number">31.4</span>  Guassian Markov Random Field</a>
  <ul class="collapse">
  <li><a href="#random-walk" id="toc-random-walk" class="nav-link" data-scroll-target="#random-walk"><span class="toc-section-number">31.4.1</span>  Random Walk</a></li>
  </ul></li>
  <li><a href="#reaction-diffusion-equations" id="toc-reaction-diffusion-equations" class="nav-link" data-scroll-target="#reaction-diffusion-equations"><span class="toc-section-number">31.5</span>  Reaction Diffusion Equations</a>
  <ul class="collapse">
  <li><a href="#grey-scott-model" id="toc-grey-scott-model" class="nav-link" data-scroll-target="#grey-scott-model"><span class="toc-section-number">31.5.1</span>  Grey-Scott Model</a></li>
  <li><a href="#sir-diffusion" id="toc-sir-diffusion" class="nav-link" data-scroll-target="#sir-diffusion"><span class="toc-section-number">31.5.2</span>  SIR Diffusion</a></li>
  <li><a href="#sis-system" id="toc-sis-system" class="nav-link" data-scroll-target="#sis-system"><span class="toc-section-number">31.5.3</span>  SIS system</a></li>
  <li><a href="#brusselator" id="toc-brusselator" class="nav-link" data-scroll-target="#brusselator"><span class="toc-section-number">31.5.4</span>  Brusselator</a></li>
  <li><a href="#lorentz-attractor" id="toc-lorentz-attractor" class="nav-link" data-scroll-target="#lorentz-attractor"><span class="toc-section-number">31.5.5</span>  Lorentz Attractor</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stochastic</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Liou </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-1_12f7fda96035e34fb540a10af557a127">

</div>
<section id="gamblers-ruin" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="gamblers-ruin"><span class="header-section-number">31.1</span> Gamblers Ruin</h2>
<p>The random walk we’re simulating is a symmetric random walk from some initial location, and calculating the expected hitting time of crossing some upper or lower boundary</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-2_b112053bbb9f288811fbced274f73217">

</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-3_547690ee80e6550caf247d8d5987b65e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">rw_sim</span>(a, b, p, k, <span class="at">return_path =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(rw) <span class="sc">-</span> <span class="dv">1</span>), rw, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"state"</span>, <span class="at">linetype =</span> <span class="st">"random walk path"</span>) <span class="sc">+</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> b, <span class="at">color =</span> <span class="st">"tomato1"</span>) <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> a, <span class="at">color =</span> <span class="st">"tomato1"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">label =</span> <span class="st">"k - initial state"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">9</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">44</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">label =</span> <span class="st">"T - hitting time"</span>, <span class="at">x =</span> <span class="dv">41</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Hitting Times of Random Walk"</span>) <span class="sc">+</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(a, b)) <span class="sc">+</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By theory, for the symmetric random walk, (see Durrett)</p>
<p><span class="math display">
\begin{aligned}
E[T|X_0 = k] = (k - a)(b - k)
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-4_727c7cb50e5c47332c8c1246ea4abdf5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hitting_times <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rw_sim</span>(a,b,p, k))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(hitting_times)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.0178</code></pre>
</div>
</div>
</section>
<section id="stochastic-processes" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="stochastic-processes"><span class="header-section-number">31.2</span> Stochastic Processes</h2>
<p>A great overview of Differential Equations in R is covered by</p>
<ul>
<li>“sde” - stochastic differential equations</li>
<li>“Sim.DiffProc”- simulate diffusion processes</li>
<li>“ReacTran” - functions for generating finite differences on a grid</li>
</ul>
<section id="wiener-process" class="level3" data-number="31.2.1">
<h3 data-number="31.2.1" class="anchored" data-anchor-id="wiener-process"><span class="header-section-number">31.2.1</span> Wiener Process</h3>
<p>The most basic wiener process takes the form, which describes Brownian motion. This differential equation models 1 dimensional diffusion, and to see this, we can imagine the probability distribution over time. Each of the sample paths are a random walk with gaussian increment with proportional</p>
<p><span class="math display">
dx = dW
</span></p>
<ul>
<li><span class="math inline">x</span> is the position, which is a function of time</li>
<li><span class="math inline">dW</span> is the Wiener Noise, gaussian distribution with</li>
</ul>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-5_c8af96190a73fb541f2552082b997685">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial position</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial time</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># how many time steps to take, </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="dv">0</span>, dt) <span class="co"># sample steps</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(x0, dx)) <span class="co"># sample path</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>rwiener <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">t0 =</span> <span class="dv">0</span>, <span class="at">dt =</span> .<span class="dv">01</span>, <span class="at">nt =</span> <span class="dv">100</span>) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  dx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt)) <span class="co"># sample steps</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cumsum</span>(<span class="fu">c</span>(x0, dx)) <span class="co"># sample path</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>wiener_paths <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">rwiener</span>())</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>wiener_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(wiener_paths, <span class="at">start =</span> t0, <span class="at">deltat =</span> dt)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(wiener_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">03</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">main =</span> <span class="st">"Wiener Sample Paths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Instead of the sample path approach, if we instead think about the probability density of our position as a function of time, we can see that the probability function becomes more diffuse over time. Thus, it’s not surprising that we can describe the diffusion with a PDE through the Fokker-Plank Equation.</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-6_5f82fc1e7c1dc12503f641cce1d7c236">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code to create animations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># animation of density</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>({</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)  {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">hist</span>(wiener_ts[i,], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">freq =</span> F,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Density of Sample Paths, Time = "</span>, i<span class="sc">*</span>dt),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"x"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt <span class="sc">*</span> i)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"theoretical density"</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}, <span class="at">movie.name =</span> <span class="st">"test.gif"</span>, <span class="at">loop =</span> T, <span class="at">interval =</span> .<span class="dv">01</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># along the sample paths</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>({</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)  {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ts.plot</span>(wiener_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">03</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">main =</span> <span class="st">"Wiener Sample Paths"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(<span class="at">v =</span> i <span class="sc">*</span> dt, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>}, <span class="at">movie.name =</span> <span class="st">"sample.gif"</span>, <span class="at">loop =</span> T, <span class="at">interval =</span> .<span class="dv">01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="sample.gif" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="test.gif" class="img-fluid"></p>
</div>
</div>
</div>
<p>The associated Fokker Plank equation associated with this stochastic differential equation, is simply the heat equation.</p>
<p><span class="math display">
\frac{\partial}{\partial t} P(x, t) =\frac{1}{2}\frac{\partial^2}{\partial x^2}P(x,t)
</span></p>
<ul>
<li>Initial condition: <span class="math inline">P(x, 0) = \delta(x)</span></li>
<li><span class="math inline">\delta(x)</span> is the delta-dirac function, which has infinite mass at 0.</li>
<li>Boundary Condition: <span class="math inline">P(a, t) = P(b, t) = 0</span>
<ul>
<li>since our simulation has to occur on some bounded region <span class="math inline">[a,b]</span>, we just set the simulation to have absorbing boundaries.</li>
</ul></li>
</ul>
<p>Solving the PDE with initial value conditions analytically, we find that the solution to this eigenvalue problem is</p>
<p><span class="math display">
\begin{aligned}
P(x, t) = \frac{1}{\sqrt{2\pi t}}\exp \left(\frac{x^2}{2t}\right)
\end{aligned}
</span></p>
<p>We can also calculate the solution by finite differencing. We can solve the PDE and show that our solutions match the rate given by the SDE formulation of the PDE. We use code from the <a href="https://rdrr.io/rforge/diffEq/f/inst/doc/PDEinR.pdf">vignette of the <code>ReacTran</code> R package</a>. <code>ReacTran</code> package uses the method of lines for solving PDE’s, in which we set up a discretized grid, and solve the ODE as a vector</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-7_a784d21a2d63f71bffe9b4120b4a36f8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ReacTran uses the</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">601</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>xgrid <span class="ot">&lt;-</span> <span class="fu">setup.grid.1D</span>(<span class="at">x.up =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">x.down =</span> <span class="dv">3</span>, <span class="at">N =</span> N) <span class="co"># grid of values</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xgrid<span class="sc">$</span>x.mid</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>D.coeff <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="co"># diffusion coefficient from solving FP</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># defines the diffusion (the derivative with respect to time)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Since our function has no time dependence, we only need to calculate the derivatives for the next step</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>Diffusion <span class="ot">&lt;-</span> <span class="cf">function</span> (t, Y, parms){</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  tran <span class="ot">&lt;-</span> <span class="fu">tran.1D</span>(<span class="at">C =</span> Y, <span class="at">C.up =</span> <span class="dv">0</span>, <span class="at">C.down =</span> <span class="dv">0</span>, <span class="co"># dirchlet boundary conditions, set to 0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">D =</span> D.coeff, <span class="at">dx =</span> xgrid)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">dY =</span> tran<span class="sc">$</span>dC)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial condition of the differential equation, we approximate the </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>Yini <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">300</span>), <span class="dv">100</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">300</span>)) <span class="co"># very tall initial mass</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(t0, dt <span class="sc">*</span> nt, dt) <span class="co">#times to simulate</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># solve heat equation</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode.1D</span>(<span class="at">y =</span> Yini, <span class="at">times =</span> tt, <span class="at">func =</span> Diffusion, <span class="at">parms =</span> <span class="cn">NULL</span>, <span class="at">dimens =</span> N)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>colorBreaks <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">255</span>)) <span class="co"># different</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">raster</span>(<span class="fu">t</span>(out[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">xmn =</span><span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">1</span>, <span class="at">ymn =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">ymx =</span> <span class="dv">3</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="cn">NA</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> colorBreaks,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="fu">length</span>(colorBreaks) <span class="sc">-</span> 1L, <span class="at">palette =</span> <span class="st">"Rocket"</span>)), <span class="at">legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"x"</span>, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ornstein-uhlenbeck-process" class="level3" data-number="31.2.2">
<h3 data-number="31.2.2" class="anchored" data-anchor-id="ornstein-uhlenbeck-process"><span class="header-section-number">31.2.2</span> Ornstein-Uhlenbeck Process</h3>
<p>Adding a drift term to the stochastic equation, gives the stochastic equation a mean. The negative in front of the drift implies that it will always regress to 0, because it’s a function of <span class="math inline">x</span> (kind of like a spring constant). The <span class="math inline">\theta</span> parameter controls how strong the restoring force is.</p>
<p><span class="math display">
dx = -\theta x\, dt + \sigma \, dW
</span></p>
<ul>
<li><span class="math inline">x</span> is position, which is a function of time.</li>
<li><span class="math inline">dW</span> is the wiener process.</li>
<li><span class="math inline">\theta</span> is the rate of return to the mean (0)</li>
<li>Variance of</li>
</ul>
<p>The following shows the effect of the parameters <span class="math inline">\theta = 3</span> and <span class="math inline">\sigma = .5</span> with initial state <span class="math inline">x_0 = 5</span>. We also show the process with a different initial state <span class="math inline">x_0 = -3</span> to show the restoring effect to the mean.</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-9_c7cd1467a31dd045b5ee3a16e7b03f90">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OU function</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ou_paths <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">npaths =</span> <span class="dv">1</span>, <span class="at">theta =</span> <span class="dv">3</span>, <span class="at">sigma =</span> .<span class="dv">5</span>, <span class="at">x0 =</span> <span class="dv">5</span>, <span class="at">nt =</span> <span class="dv">100</span>, <span class="at">t0 =</span> <span class="dv">0</span>, <span class="at">dt =</span> .<span class="dv">01</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  sde_path_ou <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> nt <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    wiener_noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt) {</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      dx <span class="ot">&lt;-</span> <span class="sc">-</span>theta <span class="sc">*</span> x[i] <span class="sc">*</span> dt <span class="sc">+</span> sigma <span class="sc">*</span> wiener_noise[i]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      x[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> dx</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="fu">replicate</span>(npaths, <span class="fu">sde_path_ou</span>()), <span class="at">start =</span> t0, <span class="at">deltat =</span> dt)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ou_ts <span class="ot">&lt;-</span> <span class="fu">ou_paths</span>(<span class="at">npaths =</span> <span class="dv">500</span>, <span class="at">theta =</span> theta, <span class="at">sigma =</span> sig, <span class="at">x0 =</span> y0, <span class="at">nt =</span> nt, <span class="at">t0 =</span> t0, <span class="at">dt =</span> dt)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(ou_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">05</span>)) <span class="co"># plot</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>theory_mean <span class="ot">&lt;-</span> y0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>theta<span class="sc">*</span>tt)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>theory_var <span class="ot">&lt;-</span> sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> tt))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(theory_var), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(theory_var), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"\u00B1 2sd"</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Because of this restoring property to the mean, a closely related stochastic process is known as the Vasicek model (commonly used to model interest rates), which adds another parameter to control what the mean is.</p>
<p><span class="math display">
dx = \theta(\mu - x)\, dt + \sigma \, dW
</span></p>
<ul>
<li><p>reduces to the 0 mean OU process when <span class="math inline">\mu = 0</span>.</p></li>
<li><p>The long term variance of this model is also</p></li>
</ul>
<p>This process is important because it’s the continuous time analogue of a discrete time AR1 process.</p>
<p>Similarly, the associated Fokker-Plank Equation for this SDE is:</p>
<p><span class="math display">
\begin{aligned}
\frac{\partial P(x, t)}{\partial t} = -\mu \frac{\partial P(x, t)}{\partial x} + \frac{\sigma^2}{2}\frac{\partial^2P(x, t)}{\partial x^2}
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-11_0046c9d3c3d3ee857e85c60442fef8ce">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation parameters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span>                       <span class="co"># time start</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span>                     <span class="co"># time step </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> <span class="dv">1</span>                       <span class="co"># time end</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> tn<span class="sc">/</span>dt                   <span class="co"># number of time steps</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tgrid <span class="ot">&lt;-</span> <span class="fu">seq</span>(t0, nt <span class="sc">*</span> dt, dt) <span class="co"># time grid</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">6</span>                       <span class="co"># space start</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>                    <span class="co"># space end</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">800</span>                     <span class="co"># number of grid points</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>xgrid <span class="ot">&lt;-</span> <span class="fu">setup.grid.1D</span>(<span class="at">x.up =</span> x0, <span class="at">x.down =</span> xn, <span class="at">N =</span> nx) <span class="co"># space grid</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xgrid<span class="sc">$</span>x.int</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span>            <span class="co"># Parameters from OU simulation</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span>             <span class="co"># Parameters from OU simulation  </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>D_coef <span class="ot">&lt;-</span> sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Diffusion function</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">100</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))                 <span class="co"># initial condition</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># advection-diffusion (method of lines)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>advec <span class="ot">&lt;-</span> <span class="cf">function</span>(t, Y, parms) {</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  trans <span class="ot">&lt;-</span> <span class="fu">tran.1D</span>(<span class="at">C =</span> Y, <span class="at">D =</span> D_coef, <span class="at">v =</span> mu<span class="sc">*</span>x, <span class="at">C.up =</span> <span class="dv">0</span>, <span class="at">C.down =</span> <span class="dv">0</span>, <span class="at">dx =</span> xgrid)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">dY =</span> trans<span class="sc">$</span>dC))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># solve advec/diffusion equation</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode.1D</span>(<span class="at">y =</span> y0, <span class="at">times =</span> tgrid, <span class="at">func =</span> advec, <span class="at">parms =</span> <span class="cn">NULL</span>, <span class="at">dimens =</span> nx)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot solution</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>colorBreaks <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">255</span>)) <span class="co"># different to capture more drift in lower parameters</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">raster</span>(<span class="fu">t</span>(out[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">xmn =</span> <span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">1</span>, <span class="at">ymn =</span> xn, <span class="at">ymx =</span> x0),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="cn">NA</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> colorBreaks,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="fu">length</span>(colorBreaks) <span class="sc">-</span> 1L, <span class="at">palette =</span> <span class="st">"Rocket"</span>)), <span class="at">legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"x"</span>, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rcOU(n=1, Dt=0.1, x0=1, theta=c(0,2,1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
ODE for Mean/Variance of OU process
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can get a First Order ODE characterization of the mean and variance for the Ornstein-Uhlenbeck process.</p>
<span class="math display">\begin{aligned}
\frac{d\langle x \rangle}{dt} = -\theta \langle x \rangle \\
\langle x\rangle = \langle x_0 \rangle e^{-\theta t}
\end{aligned}</span>
<p><span class="math display">
\frac{dV}{dt} = -2 \theta V + \sigma^2
</span></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">
dx = -\theta x\, dt + \sigma\, dW
</span> First we note the expression for the derivative of variance, and calculate the necessary components.</p>
<p><span class="math display">
\begin{align*}
\frac{dV}{dt} &amp;= \frac{d\langle x^2\rangle}{dt} - \frac{d \langle x\rangle^2}{dt} \\
&amp;= \frac{d\langle x^2\rangle}{dt} - 2 \langle x\rangle \frac{d \langle x\rangle}{dt}
\end{align*}
</span></p>
<p>Hence, we need to evaluate the mean differentials to the second order, from</p>
<p><span class="math display">
\begin{align}
d\langle x\rangle &amp;= -\theta \langle x\rangle \, dt\\
dx^2 &amp;= (x + dx)^2 - x^2 \\
&amp;=2x\,dx + (dx)^2 \\
&amp;= (-2\theta x^2 + \sigma^2)\,dt + \sigma \, dW \\
d\langle x^2\rangle &amp;= (-2\theta \langle x^2\rangle + \sigma^2)\, dt
\end{align}
</span></p>
<p>We’ve used that the rules of Ito’s calculus, that <span class="math inline">dt\,dW = 0, (dW)^2 = dt, (dt)^2 =0</span>. Plugging in the values and simplifying gives us the desired result.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-12_7989fae56d0d8136fda25c07ec50a8ef">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simplest first order ode</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ou_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, parms) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  dy <span class="ot">&lt;-</span> <span class="sc">-</span>theta <span class="sc">*</span> y</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dy))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># initial mean</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>out_mean <span class="ot">&lt;-</span> <span class="fu">ode</span>(x0, tt, ou_mean, <span class="at">parms =</span> <span class="cn">NULL</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(out_mean[,<span class="dv">2</span>],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="dv">5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span> tt)) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># matches</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 5.000000 5.000000
[2,] 4.852224 4.852228
[3,] 4.708817 4.708823
[4,] 4.569653 4.569656
[5,] 4.434600 4.434602
[6,] 4.303538 4.303540</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function coding differential equation </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ou_var <span class="ot">&lt;-</span> <span class="cf">function</span>(t, v, parms) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dv <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> v <span class="sc">+</span> sig<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dv))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial variance</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(y0, tt, ou_var, <span class="at">parms =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(out[,<span class="dv">2</span>],</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> tt))) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># matches!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]
[1,] 0.000000000 0.000000000
[2,] 0.002426880 0.002426478
[3,] 0.004712408 0.004711648
[4,] 0.006864444 0.006863741
[5,] 0.008891073 0.008890506
[6,] 0.010799760 0.010799241</code></pre>
</div>
</div>
</section>
<section id="general-linear-sde" class="level3" data-number="31.2.3">
<h3 data-number="31.2.3" class="anchored" data-anchor-id="general-linear-sde"><span class="header-section-number">31.2.3</span> General Linear SDE</h3>
<p><span class="math display">
dx = -\gamma x \, dt + g x\, dW
</span></p>
</section>
</section>
<section id="simulating-stochastic-differential-equations" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="simulating-stochastic-differential-equations"><span class="header-section-number">31.3</span> Simulating Stochastic Differential Equations</h2>
<p>Following the <a href="https://cran.r-project.org/web/packages/Sim.DiffProc/vignettes/snssde.html">package vignette</a></p>
<ul>
<li><code>rsde1d</code> - random deviates from a sde object</li>
<li><code>dsde1d()</code> - approximate density from sde object</li>
<li><code>snssde2d()</code> - simulates 2d sde</li>
</ul>
<p>We simulate from the example</p>
<p><span class="math display">
\begin{aligned}
dX = \frac{1}{2}\theta^2Xdt + \theta X dW
\end{aligned}
</span></p>
<p>Solving this for the steady state mean, then we get</p>
<p><span class="math display">
\begin{aligned}
E[X| t= 1, x_0 = 10, \theta = .5] = \exp{\left(\frac{1}{2}\theta^2t\right)}
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-13_98bae28e82ea98db785da9acad2a1b2d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sde)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Sim.DiffProc)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>, <span class="at">kind =</span> <span class="st">"L'Ecuyer-CMRG"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">expression</span>((.<span class="dv">5</span><span class="sc">*</span>theta<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">expression</span>(theta<span class="sc">*</span>x)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">snssde1d</span>(<span class="at">drift =</span> f, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">diffusion =</span> g, <span class="co"># for the random gaussian portion</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x0=</span><span class="dv">10</span>, <span class="co"># initial conditions</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">t0=</span><span class="dv">0</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">T =</span> <span class="dv">5</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">M =</span> <span class="dv">1000</span>, <span class="co"># number of sample solutions to simulate</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"ito"</span>, <span class="co"># type of integral</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euler"</span>) <span class="co"># method</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">snssde1d</span>(<span class="at">drift =</span> f, <span class="at">diffusion =</span> g, <span class="at">x0=</span><span class="dv">10</span>, <span class="at">M =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"str"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># many summary and confidence intervals.</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1, <span class="at">at =</span> .<span class="dv">3</span>) <span class="co"># by monte carlo of fitting the stochastic paths of the pandemic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo Statistics for X(t) at time t = 0.3
                             
Mean             1.017744e+01
Variance         8.046738e+00
Median           9.705629e+00
Mode             8.953720e+00
First quartile   8.137266e+00
Third quartile   1.178582e+01
Minimum          3.875000e+00
Maximum          2.458763e+01
Skewness         9.007665e-01
Kurtosis         4.327431e+00
Coef-variation   2.787220e-01
3th-order moment 2.056089e+01
4th-order moment 2.802011e+02
5th-order moment 2.130882e+03
6th-order moment 2.519499e+04</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo Statistics for X(t) at time t = 5
                             
Mean             1.852923e+01
Variance         8.618737e+02
Median           9.895477e+00
Mode             4.667985e+00
First quartile   4.490471e+00
Third quartile   2.092506e+01
Minimum          3.555266e-01
Maximum          3.234119e+02
Skewness         5.208753e+00
Kurtosis         4.095205e+01
Coef-variation   1.584399e+00
3th-order moment 1.317951e+05
4th-order moment 3.042026e+07
5th-order moment 7.738945e+09
6th-order moment 2.080372e+12</code></pre>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-14_7486d6aee22c26dad81791f753d3aebb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample from the conditional distribution, conditional on the initial value.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rsde1d</span>(mod1, <span class="at">at =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   [1]  8.735682  7.344977  8.438110 11.141480  5.586668  6.867419  7.721280
   [8] 12.731186 10.360972  6.018939 14.066648 17.632072 11.276746 11.415946
  [15]  8.265950 14.989736 14.369225  4.820591  5.271232 20.415143 17.979233
  [22] 13.230907  6.887687  2.187285 12.242744 14.272089 20.569979  7.562125
  [29] 12.919931 19.054617 18.087574  9.257144  9.943448 15.041281 12.334913
  [36] 18.685543 14.704401  4.301899 16.709410 14.305020  6.789316 13.940393
  [43]  6.961607 11.836772  4.334405 10.145721  5.925220  5.398389 15.377760
  [50] 14.162652  9.727295  9.029960  8.911256  6.229414 15.443105  9.591912
  [57]  2.272097  6.588119  4.347615 12.435848 14.882340 14.506381 14.865681
  [64] 19.749515  5.319737  6.020032  7.552928 13.851179  6.560008 11.221533
  [71] 23.895195  8.199682 13.339344  8.177069 10.998979 10.382818  6.421800
  [78]  5.117034 11.057268 13.411960 21.883071  7.458649  2.764852  7.795483
  [85]  3.494987  8.436737 29.733549 10.116049 11.144152  9.677250  5.530168
  [92]  4.957671 13.428547  4.674463  9.916626  9.569839  7.427121  8.724480
  [99] 13.887375 37.832214  4.827476  7.409082  7.590002  6.832259  5.701437
 [106] 10.939493 10.508211 10.489977  9.168765  5.442206 16.367188 12.729222
 [113]  8.394352  6.296143  6.000235 12.853669 15.592119  3.305159 19.224247
 [120] 10.097026 44.081143  5.302471  6.619034 21.294119  9.883666  7.660163
 [127] 16.111134  8.640803  9.070033  8.521571 14.957914  9.737643 14.314386
 [134]  8.301395 16.850106  4.723184 10.570269  8.751662  6.431607  6.979234
 [141]  5.511512 26.072577 15.973050 13.956336 22.281831  7.980447  5.167372
 [148] 13.633486 10.902735  4.777038  5.237959  8.998896 14.379111 16.796432
 [155] 17.796592  4.844048 15.062977  7.677406  8.445849 12.292614 10.925302
 [162]  4.170871 11.204972 12.258030  6.415237  6.684313  5.495029  6.850544
 [169] 10.913465 49.550683  7.601754  9.877510 11.417959 11.645556 31.897234
 [176] 18.124257  7.917117  9.229859 23.545624  5.907581  6.367854 16.060443
 [183] 16.906608 15.458326  7.382460 12.498490  6.763430 18.322312 12.067221
 [190]  6.080208 10.249380 18.303086 18.264506  8.728580  3.651273 11.783608
 [197]  5.060811 12.424674  8.349002  8.469587  7.752336 16.294506  7.827614
 [204]  7.571563 10.349443 12.190055  6.931615  6.369010  8.259565  9.588349
 [211] 12.020285  7.922763 14.949491 30.392037  5.264710 10.551347  3.384744
 [218] 20.320983 21.856545 11.647066  8.165454 29.861374  6.168673 19.204258
 [225]  8.919032 15.066448  6.130486  6.481084  8.632471  6.292030 40.124115
 [232]  9.637588  4.706044 17.181973 11.534985 19.559957 12.331954 20.305912
 [239] 18.928723  8.605554 23.624724 16.527202 14.367721 10.695400 12.257499
 [246] 10.192400  8.192270  7.672497 11.238924 19.316097 15.986567 15.611011
 [253] 17.519380 29.201258 11.289080  9.692351  8.599260  8.392094  5.994662
 [260]  4.420677 25.570475  3.042475 15.181913 13.223439  8.824830 17.427158
 [267] 10.109894 10.619604  9.990138 12.708607  5.451930 16.366812 17.749570
 [274] 11.251404 22.060901 13.359091  4.418347 18.234523  5.836354 10.997174
 [281]  2.883649 15.985710 18.634768 33.745729 11.946528  9.440531 16.152732
 [288] 14.880520  9.168743  8.631228 12.753438  8.075738  9.693134  8.342836
 [295] 20.006189  8.524874  8.663646  7.597066  4.401652 10.961263 15.295185
 [302] 12.127061 10.941505  7.115255  6.663204  5.789734  9.589647 22.846088
 [309] 10.453168  9.980825  3.215731  6.744712  7.847761 14.446800  8.132224
 [316]  4.591336 11.428826 15.692374  6.720083  8.102107 12.109067 19.693051
 [323] 13.334106  3.227853 21.016287 21.537173 20.175474  4.583812  7.857081
 [330]  6.969925 32.054799 10.944720  8.072071  6.843841  7.302450 10.995340
 [337]  9.145603 11.263114 17.169122 14.213967 16.979699 13.092382  7.531280
 [344] 30.619403 13.971973  9.822643  6.179722  8.576703 10.338145  6.566865
 [351]  7.620894 10.133430 15.163833 13.274279  6.832292  6.943379 18.555874
 [358] 12.687174 10.018740  6.257596 11.429321 13.087985  2.259171 20.971742
 [365]  6.334067 10.045572  8.205755 11.711326  9.118618  6.676735  8.117085
 [372] 10.928763 11.507133 15.253922 14.932853 10.061278  6.164131  6.546635
 [379]  8.625697 12.149510 11.037470  9.079694 16.082104  8.482924 14.318134
 [386] 15.781915 10.291881 21.851704 13.871237  4.276425  6.207424  8.029599
 [393] 11.960281  5.559591 17.291110  9.677869 11.317548 14.330349  7.810183
 [400] 11.656946 16.664891  8.091306  6.034429 10.601989 16.624960 14.969227
 [407] 13.382674  6.649358 13.085946 14.187247  9.598343 15.411206 13.089092
 [414] 14.619234 10.976456  4.399503 12.225032 16.272124  9.255786 13.420766
 [421] 18.237756  7.717608 18.250837  5.484751  6.033969 14.973058 11.576019
 [428] 10.466406 12.671159  8.899241  6.791583 13.422994  7.357089  9.806762
 [435]  6.560399 12.105947  7.946314 33.023914  5.394390 13.579767  6.886571
 [442] 14.622790  6.475099 12.496643  8.585582 20.881496 20.479550 17.481984
 [449]  9.297564  3.450331  3.797576  8.111555  6.171378  7.966105  7.236737
 [456]  5.465096  8.596575  7.817410 11.538488  8.766524  4.827839  4.502377
 [463]  8.901147  6.473632  6.663416 10.265154  5.874232  9.001177  5.715018
 [470]  7.121910  4.041778  8.754861  6.287263  8.973394 18.717558 26.161071
 [477] 12.311441  7.612512 10.106153  7.446709  7.541342 13.020324  9.146652
 [484]  6.766166  7.457560  8.290926 16.938588  4.856854  7.589751  7.947044
 [491]  7.950814 10.750785 10.159217 13.429467  7.771240 30.121005 12.172068
 [498]  7.950629 10.462018 18.088553 16.483523 12.694791 14.671843  4.005193
 [505] 10.586292  5.729691 16.966844 14.672584 13.066228  4.742985 12.670527
 [512] 14.901270 18.209804  7.604993 18.141755  7.688447  8.227291  8.361436
 [519]  7.597488 12.209817  6.828570 35.243991 13.958377 10.593089 13.057116
 [526]  7.254756  4.808694  5.429336  6.925283 22.640658  9.531312  9.404048
 [533]  8.583732 14.259011 13.305016 15.772552  7.110868  3.864934 34.554205
 [540]  6.916409  5.647479  9.822804  9.394861 11.844615  5.138353 19.474611
 [547] 10.302989 16.462268  8.716621  6.470711 20.181255  6.802601 15.097106
 [554]  8.314611 13.665932  4.746037 11.280094  6.382058 14.532618  4.592776
 [561]  9.385172  6.616017  4.370788 15.934445  9.220422  8.052510  6.414038
 [568]  9.319051 10.461963  9.163073 18.131839 11.405959  5.050081 14.878276
 [575]  9.440306  7.242909  9.685178 12.001159  7.626404  5.841647  9.401417
 [582] 10.913486  8.137871  8.250435  6.241282 20.503743  6.835440  4.075568
 [589] 13.317741  8.908230  9.607514  8.781462 11.559201  8.523228  6.189690
 [596]  5.004807  8.544644  6.622334  8.725181  4.556923  6.967527  9.825650
 [603]  6.800849  3.373310 11.958287  5.057759  3.275936  7.252035  7.505889
 [610]  4.961906 15.925863 10.456583  7.333704 13.069035  9.165401  8.437423
 [617] 24.225879 10.719532  9.378575 13.554836  6.170304 11.845080 12.074063
 [624] 11.107898 17.352267  6.122797  9.149488  8.901404 14.308107 11.750440
 [631] 34.384038 10.906011 28.107689  6.623738 17.509469  8.522182  5.067133
 [638] 11.250448  6.978229 13.314177 14.338646 10.854989  7.925843 13.071727
 [645] 16.835856  4.845624  9.226108 13.642872  5.772860  8.887952  5.243541
 [652]  4.263603 23.188352 13.690002 20.874907  8.918477 10.476960  6.636883
 [659]  8.761189  4.709350 11.320123 24.507418  9.163258  8.992812  8.472868
 [666]  5.879822  4.797541 12.477772  8.286386  5.717944  5.165515  9.274063
 [673] 15.228879 16.709629  6.133527 13.981494 14.309024  4.264435 26.002135
 [680] 13.968556  7.814676  5.876766 10.549172 20.794342  5.853262  8.843604
 [687]  3.812978 17.399245  7.863833 25.094374  8.615947  7.964152 13.314466
 [694] 12.680812  4.923450  6.455609 11.434462 14.541552  8.714530 12.612795
 [701]  6.163971 15.209324  6.847874  3.844012  7.103783  7.574910 10.795806
 [708] 16.410587  5.662586 13.531550 33.414515  7.564603  5.195435 13.201671
 [715]  4.325110 10.617245 10.300937 11.935363 13.869749  8.080492 15.102606
 [722] 16.282545  5.176784  5.136219  5.285879  5.625455  7.506466  4.921103
 [729]  6.765790  7.958353  7.963147  6.934881  3.619867  6.484795 10.017483
 [736] 18.284185  8.898351  7.059117  6.588445  7.935032  6.322977 41.917574
 [743] 12.404358 14.242764  5.097891 14.854218  7.547913  8.666346 13.214126
 [750]  5.100667 12.028939 10.790179 12.294230  9.122289  6.434208  5.884426
 [757] 13.364949  8.006220 19.007541 10.488436  8.082841 13.238103  6.719256
 [764]  7.227000 16.549775  7.153885 12.443782  9.452624 25.252522  9.817281
 [771] 12.822458  9.911348  5.790378  3.705566  3.895793 21.127984 11.495832
 [778] 15.299475 19.963282 11.816459  6.252820  8.443047 15.334389  6.132213
 [785] 12.981232 10.010884  5.690510 10.145072 25.650558 12.716718  6.782282
 [792]  6.562549 16.509622  6.600271 37.759372  7.100508 14.414004  3.065307
 [799] 10.515343 13.527511  7.875056 13.066810  4.108463 11.023320 11.310364
 [806]  5.734216  4.638748 11.251885  5.755294 35.481208 15.873180 17.853320
 [813] 10.019237 10.815541  7.331981 13.915003 17.168597 27.299591  4.626265
 [820] 11.234908 15.389150  5.171982 20.390825 11.365891  5.377197  5.289994
 [827]  8.019107 12.923733  6.289761  4.747143 11.767389  8.075054  7.589202
 [834]  7.063260  7.810713  7.875881  6.130386 10.039928 23.316898  7.935942
 [841]  6.674351  3.131728 16.350651  5.097724  5.988275 14.234798 12.825203
 [848]  7.611399 37.671219  4.817731  5.256682  7.979159 17.991390 21.070383
 [855]  7.529323 16.710610  7.649365  6.302058  9.598788 12.846073 13.906178
 [862]  5.188373 25.243174 22.341673  6.530109 10.424809  5.226890  3.973538
 [869]  3.990799 13.202370  9.261346 14.617998 16.655459  7.951494  5.906118
 [876]  4.769386  8.912543 15.912557  3.118072 14.157836  6.209171  9.392903
 [883]  4.554953 13.466440  3.797291  8.291070 10.196705 10.299693 22.681143
 [890] 15.534273  7.670050  6.763429 10.566136 26.770649  6.446907 12.851007
 [897]  8.038916  5.252278 10.528966  4.640688 11.907272  8.239203 13.426491
 [904] 12.509110 11.085973  4.344476  7.568144 21.025616  8.501848 16.664800
 [911]  9.309018  6.923763  7.267968  5.632527  9.304927 10.994524  3.350223
 [918] 10.126452  7.169008  2.926619  9.687305  5.026705  9.950606 10.244122
 [925]  8.669018  9.389935 12.937114  9.959240  5.039959 12.693318 11.938860
 [932]  5.696850  8.662153 10.259350 11.582157  8.450874  4.766270  3.424745
 [939] 13.851277 12.794559 20.900590 12.841001 14.012461 15.627804 30.236454
 [946] 14.350391  5.393277  9.856223  6.522718  9.223314  4.711810  8.786792
 [953] 10.369246  8.506418 11.455688  6.973830  5.460132 14.463669  5.608424
 [960] 18.667199  7.510966  8.206467  8.737598 19.988102  6.779640 26.523068
 [967]  7.889209  8.381606  6.199563 30.781468  5.955071  9.740918 17.915503
 [974] 19.661966 11.802730  9.512840 19.829487 12.278193 21.192155 15.600610
 [981]  6.838013 19.593403 11.454369  4.072621 12.941464  6.992606 15.983477
 [988]  7.864295  9.085529 12.672088  5.475907 31.787008  6.200947  7.029389
 [995]  6.273913 10.351483 10.609119  7.566718  7.227250 13.763964</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">10</span>); sigma1<span class="ot">=</span> <span class="fu">sqrt</span>(theta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">10</span>) <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span>theta<span class="sc">^</span><span class="dv">2</span>; sigma2<span class="ot">=</span> <span class="fu">sqrt</span>(theta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ito's integral</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>appdensI <span class="ot">&lt;-</span> <span class="fu">dsde1d</span>(mod1, <span class="at">at =</span> <span class="dv">1</span>) <span class="co"># conditional density estimation at particular time</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># strat integral</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>appdensS <span class="ot">&lt;-</span> <span class="fu">dsde1d</span>(mod2, <span class="at">at =</span> <span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(appdensI, <span class="at">dens =</span> <span class="cf">function</span>(x) <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> mu1, <span class="at">sdlog =</span> sigma1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(appdensS, <span class="at">dens =</span> <span class="cf">function</span>(x) <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> mu2, <span class="at">sdlog =</span> sigma2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-15_0d5202d3f465cac0745f4de42cd5eaa7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1) <span class="co"># show the plot values</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">time</span>(mod1),<span class="fu">apply</span>(mod1<span class="sc">$</span>X,<span class="dv">1</span>,mean),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">time</span>(mod1),<span class="fu">apply</span>(mod1<span class="sc">$</span>X,<span class="dv">1</span>,bconfint,<span class="at">level=</span><span class="fl">0.95</span>)[<span class="dv">1</span>,],<span class="at">col=</span><span class="dv">4</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">time</span>(mod1),<span class="fu">apply</span>(mod1<span class="sc">$</span>X,<span class="dv">1</span>,bconfint,<span class="at">level=</span><span class="fl">0.95</span>)[<span class="dv">2</span>,],<span class="at">col=</span><span class="dv">4</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"mean path"</span>,<span class="fu">paste</span>(<span class="st">"bound of"</span>, <span class="dv">95</span>,<span class="st">"% confidence"</span>)),<span class="at">inset =</span> .<span class="dv">01</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In two dimensions, vector of drift and diffusion</p>
<p><span class="math display">
\begin{aligned}
dX = -\frac{1}{\mu} Xdt + \sqrt{\sigma} dW, \quad X_0 = x_0
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-16_101bc7470a057dd4ee19be5bd3e80e91">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">=</span><span class="dv">5</span>;y0<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">3</span>;sigma<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="sc">-</span>(x<span class="sc">/</span>mu),x)  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>gx <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">sqrt</span>(sigma),<span class="dv">0</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>mod2d <span class="ot">&lt;-</span> <span class="fu">snssde2d</span>(<span class="at">drift=</span>fx,<span class="at">diffusion=</span>gx,<span class="at">Dt=</span><span class="fl">0.01</span>,<span class="at">M=</span><span class="dv">1000</span>,<span class="at">x0=</span><span class="fu">c</span>(x0,y0),<span class="at">method=</span><span class="st">"smilstein"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mod2d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Itô Sde 2D:
    | dX(t) = -(X(t)/mu) * dt + sqrt(sigma) * dW1(t)
    | dY(t) = X(t) * dt + 0 * dW2(t)
Method:
    | Second-order Milstein scheme
Summary:
    | Size of process   | N  = 1001.
    | Number of simulation  | M  = 1000.
    | Initial values    | (x0,y0) = (5,0).
    | Time of process   | t in [0,10].
    | Discretization    | Dt = 0.01.</code></pre>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-17_de6fb2ca9b5017a182d8eb4c1b982b00">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2d, <span class="at">at =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo Statistics for (X(t),Y(t)) at time t = 10
                          X             Y
Mean              0.2114239  1.473032e+01
Variance          0.7162004  2.452654e+01
Median            0.2211481  1.474951e+01
Mode              0.2740158  1.509543e+01
First quartile   -0.3465095  1.120916e+01
Third quartile    0.7881960  1.795676e+01
Minimum          -2.5031512 -1.658424e+00
Maximum           2.9862385  2.781259e+01
Skewness         -0.0183102 -1.056010e-02
Kurtosis          3.1056085  2.905123e+00
Coef-variation    4.0027928  3.362064e-01
3th-order moment -0.0110980 -1.282691e+00
4th-order moment  1.5930000  1.747580e+03
5th-order moment  0.1742750 -9.018843e+02
6th-order moment  5.9779595  1.942875e+05</code></pre>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-18_392683b52df5f4e9a33c1ef780e71937">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in time</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in plane (O,X,Y)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot2d</span>(mod2d,<span class="at">type=</span><span class="st">"n"</span>) </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points2d</span>(mod2d,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">50</span>,<span class="at">maxColorValue=</span><span class="dv">255</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="guassian-markov-random-field" class="level2" data-number="31.4">
<h2 data-number="31.4" class="anchored" data-anchor-id="guassian-markov-random-field"><span class="header-section-number">31.4</span> Guassian Markov Random Field</h2>
<p>GMRF is a generalization of the markov chians. I want to know what data actually looks like when simulated from a GMRF. We start with a line graph, which is just a standard random walk</p>
<section id="random-walk" class="level3" data-number="31.4.1">
<h3 data-number="31.4.1" class="anchored" data-anchor-id="random-walk"><span class="header-section-number">31.4.1</span> Random Walk</h3>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-19_7593a5478baae7286a6ebce16ca5ebb2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># 20 obs</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># nodes</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' Random Walk</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param N number of nodes</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>randomwalk <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nodes =</span> <span class="dv">10</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">drift =</span> <span class="dv">0</span>, <span class="at">stddev =</span> <span class="dv">1</span>) {</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  y0 <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(nodes, <span class="at">mean =</span> drift, <span class="at">sd =</span> stddev))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>rw_mat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">randomwalk</span>(<span class="dv">10</span>)) <span class="co"># 6 rows, 1000 samples</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>rw_cov <span class="ot">&lt;-</span> rw_mat <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">cov</span>() </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>rw_prec <span class="ot">&lt;-</span> rw_cov <span class="sc">%&gt;%</span> <span class="fu">solve</span>()</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(rw_prec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-20_fe014b549939b4f3ae3ac2026ecc1575">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can try to use glasso to estimate sparse patterns in the covariance matrix</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>rw_glasso <span class="ot">&lt;-</span> <span class="fu">glasso</span>(rw_cov, <span class="at">rho =</span> .<span class="dv">02</span>, <span class="at">nobs =</span> <span class="dv">1000</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>rw_glassopath <span class="ot">&lt;-</span> <span class="fu">glassopath</span>(rw_cov, <span class="at">rholist =</span> <span class="fu">seq</span>(.<span class="dv">01</span>, .<span class="dv">40</span>, .<span class="dv">01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>m
[1] 1
m
[1] 2
m
[1] 3
m
[1] 4
m
[1] 5
m
[1] 6
m
[1] 7
m
[1] 8
m
[1] 9
m
[1] 10
m
[1] 1
m
[1] 2
m
[1] 3
m
[1] 4
m
[1] 5
m
[1] 6
m
[1] 7
m
[1] 8
m
[1] 9
m
[1] 10
m
[1] 1
m
[1] 2
m
[1] 3
m
[1] 4
m
[1] 5
m
[1] 6
m
[1] 7
m
[1] 8
m
[1] 9
m
[1] 10
rho=
[1] 0.4
rho=
[1] 0.39
rho=
[1] 0.38
rho=
[1] 0.37
rho=
[1] 0.36
rho=
[1] 0.35
rho=
[1] 0.34
rho=
[1] 0.33
rho=
[1] 0.32
rho=
[1] 0.31
rho=
[1] 0.3
rho=
[1] 0.29
rho=
[1] 0.28
rho=
[1] 0.27
rho=
[1] 0.26
rho=
[1] 0.25
rho=
[1] 0.24
rho=
[1] 0.23
rho=
[1] 0.22
rho=
[1] 0.21
rho=
[1] 0.2
rho=
[1] 0.19
rho=
[1] 0.18
rho=
[1] 0.17
rho=
[1] 0.16
rho=
[1] 0.15
rho=
[1] 0.14
rho=
[1] 0.13
rho=
[1] 0.12
rho=
[1] 0.11
rho=
[1] 0.1
rho=
[1] 0.09
rho=
[1] 0.08
rho=
[1] 0.07
rho=
[1] 0.06
rho=
[1] 0.05
rho=
[1] 0.04
rho=
[1] 0.03
rho=
[1] 0.02
rho=
[1] 0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rw_glassopath<span class="sc">$</span>wi[,,<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]        [,2]        [,3]         [,4]        [,5]         [,6]
 [1,]  1.53363033 -0.59705922 -0.05045755  0.000000000 -0.05281481  0.000000000
 [2,] -0.59704118  1.46328031 -0.66740241 -0.062748027 -0.01166860  0.000000000
 [3,] -0.05045859 -0.66736724  1.48804455 -0.709396648 -0.01840336  0.000000000
 [4,]  0.00000000 -0.06272291 -0.70930973  1.502769843 -0.64832439 -0.104003565
 [5,] -0.05271855 -0.01139892 -0.01848738 -0.648268462  1.39557882 -0.614267466
 [6,]  0.00000000  0.00000000  0.00000000 -0.104181741 -0.61433940  1.450875970
 [7,]  0.00000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.685011604
 [8,]  0.00000000  0.00000000  0.00000000 -0.006829119 -0.03745143 -0.040873008
 [9,]  0.00000000 -0.00267496  0.00000000  0.000000000 -0.02218277 -0.012819793
[10,]  0.00000000  0.00000000  0.00000000  0.000000000  0.00000000 -0.005073061
             [,7]         [,8]         [,9]        [,10]
 [1,]  0.00000000  0.000000000  0.000000000  0.000000000
 [2,]  0.00000000  0.000000000 -0.002589899  0.000000000
 [3,]  0.00000000  0.000000000  0.000000000  0.000000000
 [4,]  0.00000000 -0.006867342  0.000000000  0.000000000
 [5,]  0.00000000 -0.037544676 -0.022236583  0.000000000
 [6,] -0.68516608 -0.040524630 -0.012875666 -0.005038421
 [7,]  1.44064932 -0.678296252 -0.049116046  0.000000000
 [8,] -0.67798966  1.509124167 -0.676270096 -0.090260579
 [9,] -0.04922243 -0.676158135  1.480116539 -0.719604508
[10,]  0.00000000 -0.090276515 -0.719623596  0.810028387</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(rw_glassopath<span class="sc">$</span>wi, <span class="dv">3</span>, <span class="fu">as_function</span>(<span class="sc">~</span><span class="fu">sum</span>(.x <span class="sc">!=</span> <span class="dv">0</span>))) <span class="co"># why does the number of elements increase then decrease? behavior is curious</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 80 70 64 64 60 58 58 60 60 62 62 64 68 68 68 68 70 70 70 70 70 70 72 72 72
[26] 74 74 74 74 74 74 76 78 78 78 78 78 78 78 80</code></pre>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-21_4ebf867c4acf965fdcd439cac8a0190b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>gaus <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">20</span>), <span class="at">ncol =</span> <span class="dv">20</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gaus_cov <span class="ot">&lt;-</span> <span class="fu">var</span>(gaus)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>gaus_prec <span class="ot">&lt;-</span> gaus_cov <span class="sc">%&gt;%</span> <span class="fu">solve</span>()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>gaus_prec <span class="sc">%&gt;%</span> <span class="fu">Matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">image</span>() <span class="co"># has a diagonal structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gaus_glasso <span class="ot">&lt;-</span> <span class="fu">glasso</span>(gaus_cov, <span class="at">rho =</span> .<span class="dv">03</span>, <span class="at">nobs =</span> <span class="dv">50</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>gaus_glassopath <span class="ot">&lt;-</span> <span class="fu">glassopath</span>(gaus_cov, <span class="at">rho =</span> <span class="fu">seq</span>(.<span class="dv">01</span>, .<span class="dv">7</span>, .<span class="dv">01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>rho=
[1] 0.7
rho=
[1] 0.69
rho=
[1] 0.68
rho=
[1] 0.67
rho=
[1] 0.66
rho=
[1] 0.65
rho=
[1] 0.64
rho=
[1] 0.63
rho=
[1] 0.62
rho=
[1] 0.61
rho=
[1] 0.6
rho=
[1] 0.59
rho=
[1] 0.58
rho=
[1] 0.57
rho=
[1] 0.56
rho=
[1] 0.55
rho=
[1] 0.54
rho=
[1] 0.53
rho=
[1] 0.52
rho=
[1] 0.51
rho=
[1] 0.5
rho=
[1] 0.49
rho=
[1] 0.48
rho=
[1] 0.47
rho=
[1] 0.46
rho=
[1] 0.45
rho=
[1] 0.44
rho=
[1] 0.43
rho=
[1] 0.42
rho=
[1] 0.41
rho=
[1] 0.4
rho=
[1] 0.39
rho=
[1] 0.38
rho=
[1] 0.37
rho=
[1] 0.36
rho=
[1] 0.35
rho=
[1] 0.34
rho=
[1] 0.33
rho=
[1] 0.32
rho=
[1] 0.31
rho=
[1] 0.3
rho=
[1] 0.29
rho=
[1] 0.28
rho=
[1] 0.27
rho=
[1] 0.26
rho=
[1] 0.25
rho=
[1] 0.24
rho=
[1] 0.23
rho=
[1] 0.22
rho=
[1] 0.21
rho=
[1] 0.2
rho=
[1] 0.19
rho=
[1] 0.18
rho=
[1] 0.17
rho=
[1] 0.16
rho=
[1] 0.15
rho=
[1] 0.14
rho=
[1] 0.13
rho=
[1] 0.12
rho=
[1] 0.11
rho=
[1] 0.1
rho=
[1] 0.09
rho=
[1] 0.08
rho=
[1] 0.07
rho=
[1] 0.06
rho=
[1] 0.05
rho=
[1] 0.04
rho=
[1] 0.03
rho=
[1] 0.02
rho=
[1] 0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of non-zero entries</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(gaus_glassopath<span class="sc">$</span>wi, <span class="dv">3</span>, <span class="fu">as_function</span>(<span class="sc">~</span><span class="fu">sum</span>(.x <span class="sc">!=</span> <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 366 346 326 306 276 254 238 222 208 192 180 166 158 142 126 112 104  94  88
[20]  76  66  62  56  48  46  42  32  26  26  24  24  24  24  24  24  22  22  22
[39]  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20
[58]  20  20  20  20  20  20  20  20  20  20  20  20  20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gaus_glassopath<span class="sc">$</span>wi[,,<span class="dv">60</span>] <span class="sc">%&gt;%</span> <span class="fu">image</span>() <span class="co"># sparsity pattern is correct but not the scale...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sampling from multivariate normal distribution, sparse precision matrix, we use <code>sparseMVN</code></p>
</section>
</section>
<section id="reaction-diffusion-equations" class="level2" data-number="31.5">
<h2 data-number="31.5" class="anchored" data-anchor-id="reaction-diffusion-equations"><span class="header-section-number">31.5</span> Reaction Diffusion Equations</h2>
<p>These are non-linear differential equations, and a system of them. We can start describing the reactions of SIR model as sets of nonlinear differential equations. There are a number of famous examples of these, we’ll study the Grey-Scott system, then the SIR system, and hopefully we’ll see the reaction diffusion nonlinearity around the boundaries of the different stable sets.</p>
<section id="grey-scott-model" class="level3" data-number="31.5.1">
<h3 data-number="31.5.1" class="anchored" data-anchor-id="grey-scott-model"><span class="header-section-number">31.5.1</span> Grey-Scott Model</h3>
<p>A really cool web simulation of the phenomena I want to recreate can be found by <a href="https://www.karlsims.com/rd.html">Karl Sims, Reaction Diffusion Tutorial</a>. Luckily, someone else has already implemented a version of this, and we’ll just borrow <a href="https://github.com/aschinchon/reaction-diffusion">their code (Fronkonstin)</a>.</p>
<p><img src="https://thumbs.gfycat.com/SeveralIncomparableChupacabra-size_restricted.gif" class="img-fluid" width="296"></p>
<p>The Grey-Scott Model describes the following irreversible, reactions of three compound <span class="math inline">U, V, P</span> and <span class="math inline">P</span> is an inert product.</p>
<p><span class="math display">
\begin{align*}
U + 2V &amp;\rightarrow 3V \\
V &amp;\rightarrow P
\end{align*}
</span></p>
<p>We will use the simulation parameters from <span class="citation" data-cites="pearsonComplexPatternsSimple1993">Pearson (<a href="#ref-pearsonComplexPatternsSimple1993" role="doc-biblioref">1993</a>)</span>, in particular, the equations that result from this reaction diffusion is</p>
<p><span class="math display">
\frac{\partial U}{\partial t} = D_u \nabla^2U - UV^2 + F(1 - U) \\
\frac{\partial V}{\partial t} = D_v \nabla^2V + UV^2 - (F + k)V
</span></p>
<ul>
<li><p><span class="math inline">D_u = 2 \times 10^{-5}</span></p></li>
<li><p><span class="math inline">D_v = 10^{-5}</span></p></li>
<li><p>periodic boundary condition</p></li>
<li><p><span class="math inline">F</span> and <span class="math inline">k</span> are known as the feed and kill rates of the reactants. since concentration ranges between 0 and 1, the reaction term in the first equation is positive, and then F controls how much of reactant <span class="math inline">U</span> is being introduced.</p></li>
</ul>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-25_2e1bf801b9a5cff3b47f98d16fe781a3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>gray_scott <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">U0 =</span> <span class="cn">NULL</span>, <span class="at">V0 =</span> <span class="cn">NULL</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">feed_rate =</span> <span class="fl">0.0545</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kill_rate =</span> <span class="fl">0.062</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">N =</span> <span class="dv">256</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tN =</span> <span class="dv">2000</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">D.u =</span> <span class="dv">1</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">D.v =</span> .<span class="dv">5</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">save_frame_freq =</span> <span class="dv">20</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">video_file =</span> <span class="st">"gray_scott.mp4"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pic_dir =</span> <span class="cn">NULL</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">init_strategy =</span> <span class="fu">c</span>(<span class="st">"random"</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                       ...) {</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  pct <span class="ot">&lt;-</span> <span class="fu">proc.time</span>()</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  init_strategy <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(init_strategy)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(U0) <span class="sc">|</span> <span class="fu">missing</span>(V0)) {</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#TODO: implement different initialization strategies for different patterns</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    U0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> N)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    V0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> N)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    V0[<span class="fu">sample</span>(N<span class="sc">^</span><span class="dv">2</span>, <span class="fu">ceiling</span>(N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">20</span>))] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 10% of cells</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">c</span>(<span class="fu">dim</span>(U0), <span class="fu">dim</span>(V0)) <span class="sc">==</span> N)) {</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      rlang<span class="sc">::</span><span class="fu">abort</span>(<span class="st">"Initial Matrix must be a grid with dimension N"</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> U0</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> V0</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 point stencil for Laplacian</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># yuvj420p pix format used: https://superuser.com/questions/1273920/deprecated-pixel-format-used-make-sure-you-did-set-range-correctly</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>, </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.2</span>,  <span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.2</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(pic_dir))</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    pic_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>() </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    pic_dir <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_create</span>(fs<span class="sc">::</span><span class="fu">path_wd</span>(pic_dir))</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean directory  </span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">Sys.glob</span>(fs<span class="sc">::</span><span class="fu">path</span>(pic_dir, <span class="st">"*.jpg"</span>))) <span class="sc">&gt;</span> <span class="dv">0</span> ) {</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    rlang<span class="sc">::</span><span class="fu">abort</span>(<span class="fu">sprintf</span>(<span class="st">"%s not empty, please clean out *.jpg files to prevent overwriting!"</span>, pic_dir))</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  jpeg_file <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">path</span>(pic_dir, <span class="fu">sprintf</span>(<span class="st">"plot%06d.jpg"</span>, <span class="dv">0</span>))</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">jpeg</span>(jpeg_file)</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>      <span class="co"># setup base plot graphical parameters</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">oma =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">raster</span>(V0),</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes =</span> F, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">frame.plot =</span> F,</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">interpolate =</span> F,</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="fu">hist</span>(V0, <span class="at">breaks =</span> <span class="dv">256</span>, <span class="at">plot =</span> F)<span class="sc">$</span>breaks,</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">hcl.colors</span>(<span class="dv">256</span>,  <span class="at">palette =</span> <span class="st">"ag_sunset"</span>),</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(tN <span class="sc">/</span> save_frame_freq)</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tN) {</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>    dU <span class="ot">&lt;-</span> D.u <span class="sc">*</span> <span class="fu">filter2</span>(U, L) <span class="sc">-</span> U <span class="sc">*</span> V<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> feed_rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> U)</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>    dV <span class="ot">&lt;-</span> D.v <span class="sc">*</span> <span class="fu">filter2</span>(V, L) <span class="sc">+</span> U <span class="sc">*</span> V<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (feed_rate <span class="sc">+</span> kill_rate) <span class="sc">*</span> V</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> U <span class="sc">+</span> dU</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>    V <span class="ot">&lt;-</span> V <span class="sc">+</span> dV</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save frame in temp folder</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> save_frame_freq <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="at">message =</span> <span class="fu">sprintf</span>(<span class="st">"Timestep: %g"</span>, i))</span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>      jpeg_file <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">path</span>(pic_dir,</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sprintf</span>(<span class="st">"plot%06d.jpg"</span>, i))</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">jpeg</span>(jpeg_file)</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># setup base plot graphical parameters</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">oma =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">raster</span>(V),</span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes =</span> F, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">frame.plot =</span> F,</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">interpolate =</span> T,</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="fu">hist</span>(V, <span class="at">breaks =</span> <span class="dv">256</span>, <span class="at">plot =</span> F)<span class="sc">$</span>breaks,</span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">hcl.colors</span>(<span class="dv">256</span>,  <span class="at">palette =</span> <span class="st">"ag_sunset"</span>),</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create video directory</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">dir_create</span>(fs<span class="sc">::</span><span class="fu">path_wd</span>(fs<span class="sc">::</span><span class="fu">path_dir</span>(video_file)))</span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TODO: check if ffmpeg available on system?</span></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a>  ffmpeg_cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">'ffmpeg -y -f image2 -pattern_type glob -i "%s/*.jpg" -framerate 60 -c:v libx264 -crf 20 -filter:v "format=yuvj420p" %s'</span>, pic_dir, fs<span class="sc">::</span><span class="fu">path_wd</span>(video_file))</span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run ffmpeg command</span></span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(ffmpeg_cmd)</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Running command: "</span>, ffmpeg_cmd, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proc.time</span>() <span class="sc">-</span> pct <span class="co"># elapsed wall time</span></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a><span class="co"># relative to this script (when running commands in notebook)</span></span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a><span class="fu">with_progress</span>(</span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gray_scott</span>(<span class="at">video_file =</span> <span class="st">"vid/gray_scott.mp4"</span>, <span class="at">pic_dir =</span> <span class="st">"gray_pic"</span>), <span class="at">handlers =</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)) <span class="co"># for text updates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<figure class="figure">
<video loop="" autoplay="">
<source src="vid/gray_scott.mp4" type="video/mp4">
</video>
<figcaption class="figure-caption">
Gray Scott Reaction Diffusion, <span class="math inline">f=.0545, k=.062</span>
</figcaption>
</figure>
</section>
<section id="sir-diffusion" class="level3" data-number="31.5.2">
<h3 data-number="31.5.2" class="anchored" data-anchor-id="sir-diffusion"><span class="header-section-number">31.5.2</span> SIR Diffusion</h3>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-27_7f6efdd647d59d3fe43ed4c96c0e962a">

</div>
<p>here’s we’re trying to upsample the values that come out of the</p>
<p>The SIR image has a slightly different quality to it in that the lines around the image are thinner</p>
<figure class="figure">
<video loop="" autoplay="">
<source src="vid/sir_diffusion.mp4" type="video/mp4">
</video>
<figcaption class="figure-caption">
SIR Reaction Diffusion, <span class="math inline">f=.0545, k=.062</span>
</figcaption>
</figure>
</section>
<section id="sis-system" class="level3" data-number="31.5.3">
<h3 data-number="31.5.3" class="anchored" data-anchor-id="sis-system"><span class="header-section-number">31.5.3</span> SIS system</h3>
<p>I’m curious if the SIS system without vital dynamics will show any interesting patterns. We know there must be an absorbing state, but this system can also reach an endemic state based on the reproduction number. If we add diffusion into the system we should get interesting results, at the very least some cool videos.</p>
</section>
<section id="brusselator" class="level3" data-number="31.5.4">
<h3 data-number="31.5.4" class="anchored" data-anchor-id="brusselator"><span class="header-section-number">31.5.4</span> Brusselator</h3>
</section>
<section id="lorentz-attractor" class="level3" data-number="31.5.5">
<h3 data-number="31.5.5" class="anchored" data-anchor-id="lorentz-attractor"><span class="header-section-number">31.5.5</span> Lorentz Attractor</h3>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-pearsonComplexPatternsSimple1993" class="csl-entry" role="doc-biblioentry">
Pearson, John E. 1993. <span>“Complex Patterns in a Simple System.”</span> <em>Science</em> 261 (5118): 189–92. <a href="https://doi.org/10.1126/science.261.5118.189">https://doi.org/10.1126/science.261.5118.189</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../spatial/spatial.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Spatial Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../timeseries/timeseries.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Time Series</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>