<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Liou">

<title>Personal Documentation - 3&nbsp; Stochastic</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../meta/meta.html" rel="next">
<link href="../matrix/matrix.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stochastic</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Personal Documentation</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Front Page</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matrix/matrix.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrix Math</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic/stochastic.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stochastic</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../meta/meta.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Meta Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">From Informational</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bootstrap/bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../causal/causal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Causal Statistics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../color/color.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Colors in R</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#gamblers-ruin" id="toc-gamblers-ruin" class="nav-link active" data-scroll-target="#gamblers-ruin"><span class="toc-section-number">3.1</span>  Gamblers Ruin</a></li>
  <li><a href="#stochastic-processes" id="toc-stochastic-processes" class="nav-link" data-scroll-target="#stochastic-processes"><span class="toc-section-number">3.2</span>  Stochastic Processes</a>
  <ul class="collapse">
  <li><a href="#wiener-process" id="toc-wiener-process" class="nav-link" data-scroll-target="#wiener-process"><span class="toc-section-number">3.2.1</span>  Wiener Process</a></li>
  <li><a href="#ornstein-uhlenbeck-process" id="toc-ornstein-uhlenbeck-process" class="nav-link" data-scroll-target="#ornstein-uhlenbeck-process"><span class="toc-section-number">3.2.2</span>  Ornstein-Uhlenbeck Process</a></li>
  <li><a href="#general-linear-sde" id="toc-general-linear-sde" class="nav-link" data-scroll-target="#general-linear-sde"><span class="toc-section-number">3.2.3</span>  General Linear SDE</a></li>
  </ul></li>
  <li><a href="#reaction-diffusion-equations" id="toc-reaction-diffusion-equations" class="nav-link" data-scroll-target="#reaction-diffusion-equations"><span class="toc-section-number">3.3</span>  Reaction Diffusion Equations</a>
  <ul class="collapse">
  <li><a href="#grey-scott-model" id="toc-grey-scott-model" class="nav-link" data-scroll-target="#grey-scott-model"><span class="toc-section-number">3.3.1</span>  Grey-Scott Model</a></li>
  <li><a href="#sir-diffusion" id="toc-sir-diffusion" class="nav-link" data-scroll-target="#sir-diffusion"><span class="toc-section-number">3.3.2</span>  SIR Diffusion</a></li>
  <li><a href="#sis-system" id="toc-sis-system" class="nav-link" data-scroll-target="#sis-system"><span class="toc-section-number">3.3.3</span>  SIS system</a></li>
  <li><a href="#brusselator" id="toc-brusselator" class="nav-link" data-scroll-target="#brusselator"><span class="toc-section-number">3.3.4</span>  Brusselator</a></li>
  <li><a href="#lorentz-attractor" id="toc-lorentz-attractor" class="nav-link" data-scroll-target="#lorentz-attractor"><span class="toc-section-number">3.3.5</span>  Lorentz Attractor</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stochastic</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Liou </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-1_c04304976085b735d0585022fd25dea5">

</div>
<section id="gamblers-ruin" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="gamblers-ruin"><span class="header-section-number">3.1</span> Gamblers Ruin</h2>
<p>The random walk we’re simulating is a symmetric random walk from some initial location, and calculating the expected hitting time of crossing some upper or lower boundary</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-2_b112053bbb9f288811fbced274f73217">

</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-3_547690ee80e6550caf247d8d5987b65e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">rw_sim</span>(a, b, p, k, <span class="at">return_path =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="dv">0</span><span class="sc">:</span>(<span class="fu">length</span>(rw) <span class="sc">-</span> <span class="dv">1</span>), rw, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"state"</span>, <span class="at">linetype =</span> <span class="st">"random walk path"</span>) <span class="sc">+</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> b, <span class="at">color =</span> <span class="st">"tomato1"</span>) <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> a, <span class="at">color =</span> <span class="st">"tomato1"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">label =</span> <span class="st">"k - initial state"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">9</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">44</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">label =</span> <span class="st">"T - hitting time"</span>, <span class="at">x =</span> <span class="dv">41</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">""</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Hitting Times of Random Walk"</span>) <span class="sc">+</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(a, b)) <span class="sc">+</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By theory, for the symmetric random walk, (see Durrett)</p>
<p><span class="math display">
\begin{aligned}
E[T|X_0 = k] = (k - a)(b - k)
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-4_727c7cb50e5c47332c8c1246ea4abdf5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hitting_times <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rw_sim</span>(a,b,p, k))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(hitting_times)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.0178</code></pre>
</div>
</div>
</section>
<section id="stochastic-processes" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="stochastic-processes"><span class="header-section-number">3.2</span> Stochastic Processes</h2>
<p>A great overview of Differential Equations in R is covered by</p>
<ul>
<li><p>“sde” - stochastic differential equations</p></li>
<li><p>“Sim.DiffProc”- simulate diffusion processes</p></li>
<li><p>“ReacTran” - functions for generating finite differences on a grid</p></li>
</ul>
<section id="wiener-process" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="wiener-process"><span class="header-section-number">3.2.1</span> Wiener Process</h3>
<p>The most basic wiener process takes the form, which describes Brownian motion. This differential equation models 1 dimensional diffusion, and to see this, we can imagine the probability distribution over time. Each of the sample paths are a random walk with gaussian increment with proportional</p>
<p><span class="math display">
dx = dW
</span></p>
<ul>
<li><span class="math inline">x</span> is the position, which is a function of time</li>
<li><span class="math inline">dW</span> is the Wiener Noise, gaussian distribution with</li>
</ul>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-5_c8af96190a73fb541f2552082b997685">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial position</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial time</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># how many time steps to take, </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="dv">0</span>, dt) <span class="co"># sample steps</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(x0, dx)) <span class="co"># sample path</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>rwiener <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">t0 =</span> <span class="dv">0</span>, <span class="at">dt =</span> .<span class="dv">01</span>, <span class="at">nt =</span> <span class="dv">100</span>) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  dx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="dv">0</span>, <span class="fu">sqrt</span>(dt)) <span class="co"># sample steps</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cumsum</span>(<span class="fu">c</span>(x0, dx)) <span class="co"># sample path</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>wiener_paths <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">2000</span>, <span class="fu">rwiener</span>())</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>wiener_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(wiener_paths, <span class="at">start =</span> t0, <span class="at">deltat =</span> dt)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(wiener_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">03</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">main =</span> <span class="st">"Wiener Sample Paths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Instead of the sample path approach, if we instead think about the probability density of our position as a function of time, we can see that the probability function becomes more diffuse over time. Thus, it’s not surprising that we can describe the diffusion with a PDE through the Fokker-Plank Equation.</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-6_5f82fc1e7c1dc12503f641cce1d7c236">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code to create animations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># animation of density</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>({</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)  {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">hist</span>(wiener_ts[i,], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">freq =</span> F,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Density of Sample Paths, Time = "</span>, i<span class="sc">*</span>dt),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"x"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt <span class="sc">*</span> i)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"theoretical density"</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}, <span class="at">movie.name =</span> <span class="st">"test.gif"</span>, <span class="at">loop =</span> T, <span class="at">interval =</span> .<span class="dv">01</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># along the sample paths</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>({</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)  {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ts.plot</span>(wiener_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">03</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">main =</span> <span class="st">"Wiener Sample Paths"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(<span class="at">v =</span> i <span class="sc">*</span> dt, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>}, <span class="at">movie.name =</span> <span class="st">"sample.gif"</span>, <span class="at">loop =</span> T, <span class="at">interval =</span> .<span class="dv">01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="sample.gif" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="test.gif" class="img-fluid"></p>
</div>
</div>
</div>
<p>The associated Fokker Plank equation associated with this stochastic differential equation, is simply the heat equation.</p>
<p><span class="math display">
\frac{\partial}{\partial t} P(x, t) =\frac{1}{2}\frac{\partial^2}{\partial x^2}P(x,t)
</span></p>
<ul>
<li>Initial condition: <span class="math inline">P(x, 0) = \delta(x)</span></li>
<li><span class="math inline">\delta(x)</span> is the delta-dirac function, which has infinite mass at 0.</li>
<li>Boundary Condition: <span class="math inline">P(a, t) = P(b, t) = 0</span>
<ul>
<li>since our simulation has to occur on some bounded region <span class="math inline">[a,b]</span>, we just set the simulation to have absorbing boundaries.</li>
</ul></li>
</ul>
<p>Solving the PDE with initial value conditions analytically, we find that the solution to this eigenvalue problem is</p>
<p><span class="math display">
\begin{aligned}
P(x, t) = \frac{1}{\sqrt{2\pi t}}\exp \left(\frac{x^2}{2t}\right)
\end{aligned}
</span></p>
<p>We can also calculate the solution by finite differencing. We can solve the PDE and show that our solutions match the rate given by the SDE formulation of the PDE. We use code from the <a href="https://rdrr.io/rforge/diffEq/f/inst/doc/PDEinR.pdf">vignette of the <code>ReacTran</code> R package</a>. <code>ReacTran</code> package uses the method of lines for solving PDE’s, in which we set up a discretized grid, and solve the ODE as a vector</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-7_a784d21a2d63f71bffe9b4120b4a36f8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ReacTran uses the</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">601</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>xgrid <span class="ot">&lt;-</span> <span class="fu">setup.grid.1D</span>(<span class="at">x.up =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">x.down =</span> <span class="dv">3</span>, <span class="at">N =</span> N) <span class="co"># grid of values</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xgrid<span class="sc">$</span>x.mid</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>D.coeff <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="co"># diffusion coefficient from solving FP</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># defines the diffusion (the derivative with respect to time)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Since our function has no time dependence, we only need to calculate the derivatives for the next step</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>Diffusion <span class="ot">&lt;-</span> <span class="cf">function</span> (t, Y, parms){</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  tran <span class="ot">&lt;-</span> <span class="fu">tran.1D</span>(<span class="at">C =</span> Y, <span class="at">C.up =</span> <span class="dv">0</span>, <span class="at">C.down =</span> <span class="dv">0</span>, <span class="co"># dirchlet boundary conditions, set to 0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">D =</span> D.coeff, <span class="at">dx =</span> xgrid)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">dY =</span> tran<span class="sc">$</span>dC)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial condition of the differential equation, we approximate the </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>Yini <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">300</span>), <span class="dv">100</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">300</span>)) <span class="co"># very tall initial mass</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(t0, dt <span class="sc">*</span> nt, dt) <span class="co">#times to simulate</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># solve heat equation</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode.1D</span>(<span class="at">y =</span> Yini, <span class="at">times =</span> tt, <span class="at">func =</span> Diffusion, <span class="at">parms =</span> <span class="cn">NULL</span>, <span class="at">dimens =</span> N)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>colorBreaks <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">255</span>)) <span class="co"># different</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">raster</span>(<span class="fu">t</span>(out[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">xmn =</span><span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">1</span>, <span class="at">ymn =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">ymx =</span> <span class="dv">3</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="cn">NA</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> colorBreaks,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="fu">length</span>(colorBreaks) <span class="sc">-</span> 1L, <span class="at">palette =</span> <span class="st">"Rocket"</span>)), <span class="at">legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"x"</span>, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ornstein-uhlenbeck-process" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="ornstein-uhlenbeck-process"><span class="header-section-number">3.2.2</span> Ornstein-Uhlenbeck Process</h3>
<p>Adding a drift term to the stochastic equation, gives the stochastic equation a mean. The negative in front of the drift implies that it will always regress to 0, because it’s a function of <span class="math inline">x</span> (kind of like a spring constant). The <span class="math inline">\theta</span> parameter controls how strong the restoring force is.</p>
<p><span class="math display">
dx = -\theta x\, dt + \sigma \, dW
</span></p>
<ul>
<li><span class="math inline">x</span> is position, which is a function of time.</li>
<li><span class="math inline">dW</span> is the wiener process.</li>
<li><span class="math inline">\theta</span> is the rate of return to the mean (0)</li>
<li>Variance of</li>
</ul>
<p>The following shows the effect of the parameters <span class="math inline">\theta = 3</span> and <span class="math inline">\sigma = .5</span> with initial state <span class="math inline">x_0 = 5</span>. We also show the process with a different initial state <span class="math inline">x_0 = -3</span> to show the restoring effect to the mean.</p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-9_c7cd1467a31dd045b5ee3a16e7b03f90">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OU function</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ou_paths <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">npaths =</span> <span class="dv">1</span>, <span class="at">theta =</span> <span class="dv">3</span>, <span class="at">sigma =</span> .<span class="dv">5</span>, <span class="at">x0 =</span> <span class="dv">5</span>, <span class="at">nt =</span> <span class="dv">100</span>, <span class="at">t0 =</span> <span class="dv">0</span>, <span class="at">dt =</span> .<span class="dv">01</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  sde_path_ou <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> nt <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    wiener_noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nt, <span class="at">sd =</span> <span class="fu">sqrt</span>(dt))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt) {</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      dx <span class="ot">&lt;-</span> <span class="sc">-</span>theta <span class="sc">*</span> x[i] <span class="sc">*</span> dt <span class="sc">+</span> sigma <span class="sc">*</span> wiener_noise[i]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      x[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> dx</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="fu">replicate</span>(npaths, <span class="fu">sde_path_ou</span>()), <span class="at">start =</span> t0, <span class="at">deltat =</span> dt)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ou_ts <span class="ot">&lt;-</span> <span class="fu">ou_paths</span>(<span class="at">npaths =</span> <span class="dv">500</span>, <span class="at">theta =</span> theta, <span class="at">sigma =</span> sig, <span class="at">x0 =</span> y0, <span class="at">nt =</span> nt, <span class="at">t0 =</span> t0, <span class="at">dt =</span> dt)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(ou_ts, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="at">alpha =</span> .<span class="dv">05</span>)) <span class="co"># plot</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>theory_mean <span class="ot">&lt;-</span> y0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>theta<span class="sc">*</span>tt)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>theory_var <span class="ot">&lt;-</span> sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> tt))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(theory_var), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tt, theory_mean <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(theory_var), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"\u00B1 2sd"</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Because of this restoring property to the mean, a closely related stochastic process is known as the Vasicek model (commonly used to model interest rates), which adds another parameter to control what the mean is.</p>
<p><span class="math display">
dx = \theta(\mu - x)\, dt + \sigma \, dW
</span></p>
<ul>
<li><p>reduces to the 0 mean OU process when <span class="math inline">\mu = 0</span>.</p></li>
<li><p>The long term variance of this model is also</p></li>
</ul>
<p>This process is important because it’s the continuous time analogue of a discrete time AR1 process.</p>
<p>Similarly, the associated Fokker-Plank Equation for this SDE is:</p>
<p><span class="math display">
\begin{aligned}
\frac{\partial P(x, t)}{\partial t} = -\mu \frac{\partial P(x, t)}{\partial x} + \frac{\sigma^2}{2}\frac{\partial^2P(x, t)}{\partial x^2}
\end{aligned}
</span></p>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-11_0046c9d3c3d3ee857e85c60442fef8ce">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation parameters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="dv">0</span>                       <span class="co"># time start</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">01</span>                     <span class="co"># time step </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> <span class="dv">1</span>                       <span class="co"># time end</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> tn<span class="sc">/</span>dt                   <span class="co"># number of time steps</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tgrid <span class="ot">&lt;-</span> <span class="fu">seq</span>(t0, nt <span class="sc">*</span> dt, dt) <span class="co"># time grid</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">6</span>                       <span class="co"># space start</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>                    <span class="co"># space end</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">800</span>                     <span class="co"># number of grid points</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>xgrid <span class="ot">&lt;-</span> <span class="fu">setup.grid.1D</span>(<span class="at">x.up =</span> x0, <span class="at">x.down =</span> xn, <span class="at">N =</span> nx) <span class="co"># space grid</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xgrid<span class="sc">$</span>x.int</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span>            <span class="co"># Parameters from OU simulation</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span>             <span class="co"># Parameters from OU simulation  </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>D_coef <span class="ot">&lt;-</span> sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Diffusion function</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dv">100</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))                 <span class="co"># initial condition</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># advection-diffusion (method of lines)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>advec <span class="ot">&lt;-</span> <span class="cf">function</span>(t, Y, parms) {</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  trans <span class="ot">&lt;-</span> <span class="fu">tran.1D</span>(<span class="at">C =</span> Y, <span class="at">D =</span> D_coef, <span class="at">v =</span> mu<span class="sc">*</span>x, <span class="at">C.up =</span> <span class="dv">0</span>, <span class="at">C.down =</span> <span class="dv">0</span>, <span class="at">dx =</span> xgrid)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">dY =</span> trans<span class="sc">$</span>dC))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># solve advec/diffusion equation</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode.1D</span>(<span class="at">y =</span> y0, <span class="at">times =</span> tgrid, <span class="at">func =</span> advec, <span class="at">parms =</span> <span class="cn">NULL</span>, <span class="at">dimens =</span> nx)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot solution</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>colorBreaks <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">255</span>)) <span class="co"># different to capture more drift in lower parameters</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">raster</span>(<span class="fu">t</span>(out[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">xmn =</span> <span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">1</span>, <span class="at">ymn =</span> xn, <span class="at">ymx =</span> x0),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="cn">NA</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> colorBreaks,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="fu">length</span>(colorBreaks) <span class="sc">-</span> 1L, <span class="at">palette =</span> <span class="st">"Rocket"</span>)), <span class="at">legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"x"</span>, <span class="at">interpolate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="stochastic_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rcOU(n=1, Dt=0.1, x0=1, theta=c(0,2,1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
ODE for Mean/Variance of OU process
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can get a First Order ODE characterization of the mean and variance for the Ornstein-Uhlenbeck process.</p>
<span class="math display">\begin{aligned}
\frac{d\langle x \rangle}{dt} = -\theta \langle x \rangle \\
\langle x\rangle = \langle x_0 \rangle e^{-\theta t}
\end{aligned}</span>
<p><span class="math display">
\frac{dV}{dt} = -2 \theta V + \sigma^2
</span></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">
dx = -\theta x\, dt + \sigma\, dW
</span> First we note the expression for the derivative of variance, and calculate the necessary components.</p>
<p><span class="math display">
\begin{align*}
\frac{dV}{dt} &amp;= \frac{d\langle x^2\rangle}{dt} - \frac{d \langle x\rangle^2}{dt} \\
&amp;= \frac{d\langle x^2\rangle}{dt} - 2 \langle x\rangle \frac{d \langle x\rangle}{dt}
\end{align*}
</span></p>
<p>Hence, we need to evaluate the mean differentials to the second order, from</p>
<p><span class="math display">
\begin{align}
d\langle x\rangle &amp;= -\theta \langle x\rangle \, dt\\
dx^2 &amp;= (x + dx)^2 - x^2 \\
&amp;=2x\,dx + (dx)^2 \\
&amp;= (-2\theta x^2 + \sigma^2)\,dt + \sigma \, dW \\
d\langle x^2\rangle &amp;= (-2\theta \langle x^2\rangle + \sigma^2)\, dt
\end{align}
</span></p>
<p>We’ve used that the rules of Ito’s calculus, that <span class="math inline">dt\,dW = 0, (dW)^2 = dt, (dt)^2 =0</span>. Plugging in the values and simplifying gives us the desired result.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-12_7989fae56d0d8136fda25c07ec50a8ef">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simplest first order ode</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ou_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, parms) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  dy <span class="ot">&lt;-</span> <span class="sc">-</span>theta <span class="sc">*</span> y</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dy))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># initial mean</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>out_mean <span class="ot">&lt;-</span> <span class="fu">ode</span>(x0, tt, ou_mean, <span class="at">parms =</span> <span class="cn">NULL</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(out_mean[,<span class="dv">2</span>],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="dv">5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span> tt)) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># matches</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]
[1,] 5.000000 5.000000
[2,] 4.852224 4.852228
[3,] 4.708817 4.708823
[4,] 4.569653 4.569656
[5,] 4.434600 4.434602
[6,] 4.303538 4.303540</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function coding differential equation </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ou_var <span class="ot">&lt;-</span> <span class="cf">function</span>(t, v, parms) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dv <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> v <span class="sc">+</span> sig<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dv))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># initial variance</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(y0, tt, ou_var, <span class="at">parms =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(out[,<span class="dv">2</span>],</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> tt))) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># matches!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]
[1,] 0.000000000 0.000000000
[2,] 0.002426880 0.002426478
[3,] 0.004712408 0.004711648
[4,] 0.006864444 0.006863741
[5,] 0.008891073 0.008890506
[6,] 0.010799760 0.010799241</code></pre>
</div>
</div>
</section>
<section id="general-linear-sde" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="general-linear-sde"><span class="header-section-number">3.2.3</span> General Linear SDE</h3>
<p><span class="math display">
dx = -\gamma x \, dt + g x\, dW
</span></p>
</section>
</section>
<section id="reaction-diffusion-equations" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="reaction-diffusion-equations"><span class="header-section-number">3.3</span> Reaction Diffusion Equations</h2>
<p>These are non-linear differential equations, and a system of them. We can start describing the reactions of SIR model as sets of nonlinear differential equations. There are a number of famous examples of these, we’ll study the Grey-Scott system, then the SIR system, and hopefully we’ll see the reaction diffusion nonlinearity around the boundaries of the different stable sets.</p>
<section id="grey-scott-model" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="grey-scott-model"><span class="header-section-number">3.3.1</span> Grey-Scott Model</h3>
<p>A really cool web simulation of the phenomena I want to recreate can be found by <a href="https://www.karlsims.com/rd.html">Karl Sims, Reaction Diffusion Tutorial</a>. Luckily, someone else has already implemented a version of this, and we’ll just borrow <a href="https://github.com/aschinchon/reaction-diffusion">their code (Fronkonstin)</a>.</p>
<p><img src="https://thumbs.gfycat.com/SeveralIncomparableChupacabra-size_restricted.gif" class="img-fluid" width="296"></p>
<p>The Grey-Scott Model describes the following irreversible, reactions of three compound <span class="math inline">U, V, P</span> and <span class="math inline">P</span> is an inert product.</p>
<p><span class="math display">
\begin{align*}
U + 2V &amp;\rightarrow 3V \\
V &amp;\rightarrow P
\end{align*}
</span></p>
<p>We will use the simulation parameters from <span class="citation" data-cites="pearsonComplexPatternsSimple1993">Pearson (<a href="#ref-pearsonComplexPatternsSimple1993" role="doc-biblioref">1993</a>)</span>, in particular, the equations that result from this reaction diffusion is</p>
<p><span class="math display">
\frac{\partial U}{\partial t} = D_u \nabla^2U - UV^2 + F(1 - U) \\
\frac{\partial V}{\partial t} = D_v \nabla^2V + UV^2 - (F + k)V
</span></p>
<ul>
<li><p><span class="math inline">D_u = 2 \times 10^{-5}</span></p></li>
<li><p><span class="math inline">D_v = 10^{-5}</span></p></li>
<li><p>periodic boundary condition</p></li>
<li><p><span class="math inline">F</span> and <span class="math inline">k</span> are known as the feed and kill rates of the reactants. since concentration ranges between 0 and 1, the reaction term in the first equation is positive, and then F controls how much of reactant <span class="math inline">U</span> is being introduced.</p></li>
</ul>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-15_6cd608d40047ba8981a787f912fc0faa">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gray_scott <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">U0 =</span> <span class="cn">NULL</span>, <span class="at">V0 =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">feed_rate =</span> <span class="fl">0.0545</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kill_rate =</span> <span class="fl">0.062</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">N =</span> <span class="dv">256</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tN =</span> <span class="dv">2000</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">D.u =</span> <span class="dv">1</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">D.v =</span> .<span class="dv">5</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">save_frame_freq =</span> <span class="dv">20</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">video_file =</span> <span class="st">"gray_scott.mp4"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pic_dir =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">init_strategy =</span> <span class="fu">c</span>(<span class="st">"random"</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                       ...) {</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  pct <span class="ot">&lt;-</span> <span class="fu">proc.time</span>()</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  init_strategy <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(init_strategy)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(U0) <span class="sc">|</span> <span class="fu">missing</span>(V0)) {</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#TODO: implement different initialization strategies for different patterns</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    U0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> N)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    V0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> N)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    V0[<span class="fu">sample</span>(N<span class="sc">^</span><span class="dv">2</span>, <span class="fu">ceiling</span>(N<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">20</span>))] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 10% of cells</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">c</span>(<span class="fu">dim</span>(U0), <span class="fu">dim</span>(V0)) <span class="sc">==</span> N)) {</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      rlang<span class="sc">::</span><span class="fu">abort</span>(<span class="st">"Initial Matrix must be a grid with dimension N"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> U0</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> V0</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 point stencil for Laplacian</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># yuvj420p pix format used: https://superuser.com/questions/1273920/deprecated-pixel-format-used-make-sure-you-did-set-range-correctly</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>, </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.2</span>,  <span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.2</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(pic_dir))</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    pic_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>() </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    pic_dir <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_create</span>(fs<span class="sc">::</span><span class="fu">path_wd</span>(pic_dir))</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean directory  </span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">Sys.glob</span>(fs<span class="sc">::</span><span class="fu">path</span>(pic_dir, <span class="st">"*.jpg"</span>))) <span class="sc">&gt;</span> <span class="dv">0</span> ) {</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    rlang<span class="sc">::</span><span class="fu">abort</span>(<span class="fu">sprintf</span>(<span class="st">"%s not empty, please clean out *.jpg files to prevent overwriting!"</span>, pic_dir))</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  jpeg_file <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">path</span>(pic_dir, <span class="fu">sprintf</span>(<span class="st">"plot%06d.jpg"</span>, <span class="dv">0</span>))</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">jpeg</span>(jpeg_file)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>      <span class="co"># setup base plot graphical parameters</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">oma =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">raster</span>(V0),</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes =</span> F, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">frame.plot =</span> F,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">interpolate =</span> F,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="fu">hist</span>(V0, <span class="at">breaks =</span> <span class="dv">256</span>, <span class="at">plot =</span> F)<span class="sc">$</span>breaks,</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">hcl.colors</span>(<span class="dv">256</span>,  <span class="at">palette =</span> <span class="st">"ag_sunset"</span>),</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(tN <span class="sc">/</span> save_frame_freq)</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tN) {</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    dU <span class="ot">&lt;-</span> D.u <span class="sc">*</span> <span class="fu">filter2</span>(U, L) <span class="sc">-</span> U <span class="sc">*</span> V<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> feed_rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> U)</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    dV <span class="ot">&lt;-</span> D.v <span class="sc">*</span> <span class="fu">filter2</span>(V, L) <span class="sc">+</span> U <span class="sc">*</span> V<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (feed_rate <span class="sc">+</span> kill_rate) <span class="sc">*</span> V</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> U <span class="sc">+</span> dU</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>    V <span class="ot">&lt;-</span> V <span class="sc">+</span> dV</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save frame in temp folder</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%%</span> save_frame_freq <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="at">message =</span> <span class="fu">sprintf</span>(<span class="st">"Timestep: %g"</span>, i))</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>      jpeg_file <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">path</span>(pic_dir,</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sprintf</span>(<span class="st">"plot%06d.jpg"</span>, i))</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">jpeg</span>(jpeg_file)</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># setup base plot graphical parameters</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">oma =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(<span class="fu">raster</span>(V),</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">axes =</span> F, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">frame.plot =</span> F,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">interpolate =</span> T,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="fu">hist</span>(V, <span class="at">breaks =</span> <span class="dv">256</span>, <span class="at">plot =</span> F)<span class="sc">$</span>breaks,</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">hcl.colors</span>(<span class="dv">256</span>,  <span class="at">palette =</span> <span class="st">"ag_sunset"</span>),</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create video directory</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">dir_create</span>(fs<span class="sc">::</span><span class="fu">path_wd</span>(fs<span class="sc">::</span><span class="fu">path_dir</span>(video_file)))</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TODO: check if ffmpeg available on system?</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  ffmpeg_cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">'ffmpeg -y -f image2 -pattern_type glob -i "%s/*.jpg" -framerate 60 -c:v libx264 -crf 20 -filter:v "format=yuvj420p" %s'</span>, pic_dir, fs<span class="sc">::</span><span class="fu">path_wd</span>(video_file))</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run ffmpeg command</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(ffmpeg_cmd)</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Running command: "</span>, ffmpeg_cmd, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proc.time</span>() <span class="sc">-</span> pct <span class="co"># elapsed wall time</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a><span class="co"># relative to this script (when running commands in notebook)</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a><span class="fu">with_progress</span>(</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gray_scott</span>(<span class="at">video_file =</span> <span class="st">"vid/gray_scott.mp4"</span>, <span class="at">pic_dir =</span> <span class="st">"gray_pic"</span>), <span class="at">handlers =</span> <span class="fu">handlers</span>(<span class="st">"progress"</span>)) <span class="co"># for text updates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<figure class="figure">
<video loop="" autoplay="">
<source src="vid/gray_scott.mp4" type="video/mp4">
</video>
<figcaption class="figure-caption">
Gray Scott Reaction Diffusion, <span class="math inline">f=.0545, k=.062</span>
</figcaption>
</figure>
</section>
<section id="sir-diffusion" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="sir-diffusion"><span class="header-section-number">3.3.2</span> SIR Diffusion</h3>
<div class="cell" data-hash="stochastic_cache/html/unnamed-chunk-17_46c0d52b022de8b7863ccc4f4592c7ae">

</div>
<p>here’s we’re trying to upsample the values that come out of the</p>
<p>The SIR image has a slightly different quality to it in that the lines around the image are thinner</p>
<figure class="figure">
<video loop="" autoplay="">
<source src="vid/sir_diffusion.mp4" type="video/mp4">
</video>
<figcaption class="figure-caption">
SIR Reaction Diffusion, <span class="math inline">f=.0545, k=.062</span>
</figcaption>
</figure>
</section>
<section id="sis-system" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="sis-system"><span class="header-section-number">3.3.3</span> SIS system</h3>
<p>I’m curious if the SIS system without vital dynamics will show any interesting patterns. We know there must be an absorbing state, but this system can also reach an endemic state based on the reproduction number. If we add diffusion into the system we should get interesting results, at the very least some cool videos.</p>
</section>
<section id="brusselator" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="brusselator"><span class="header-section-number">3.3.4</span> Brusselator</h3>
</section>
<section id="lorentz-attractor" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="lorentz-attractor"><span class="header-section-number">3.3.5</span> Lorentz Attractor</h3>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-pearsonComplexPatternsSimple1993" class="csl-entry" role="doc-biblioentry">
Pearson, John E. 1993. <span>“Complex Patterns in a Simple System.”</span> <em>Science</em> 261 (5118): 189–92. <a href="https://doi.org/10.1126/science.261.5118.189">https://doi.org/10.1126/science.261.5118.189</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../matrix/matrix.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrix Math</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../meta/meta.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Meta Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>